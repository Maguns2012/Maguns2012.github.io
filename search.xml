<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[å†™åœ¨18å¹´çš„æ€»ç»“]]></title>
    <url>%2F2018%2F02%2F10%2F%E5%86%99%E5%9C%A818%E5%B9%B4%E7%9A%84%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[###ä¸å¤ªå®‰ç¨³çš„ä¸€å¹´å¹´åˆæ—¶è§‰å¾—å…¬å¸çš„è¿ä½œæ¨¡å¼æœ‰é—®é¢˜ï¼Œç¢äºŽè‡ªå·±èŒä½å‘å¾®æ²¡æœ‰è¯´æ˜Žï¼Œæƒ³ç€æœ‰æ—¶é—´å°±è·³èµ°ã€‚å¹´ä¸­èµ¶ä¸Šå…¬å¸è¢«è¾žèŒæ½®ï¼ˆç¾Žå…¶åæ›°ï¼Œå…¬å¸å‘å±•æ”¹å˜å‘å¼ åå‘ï¼Œä½ ä»¬å¯ä»¥è‡ªåŠ¨ç”³è¯·ç¦»èŒã€‚å…¶ä»–æ— ï¼‰0 0.æœ¬æƒ³ç€è·Ÿç€å¤§éƒ¨é˜Ÿèµ°äº†ç®—çƒï¼Œä½†æ˜¯æŒ¨ä¸ä½é¢†å¯¼åŠè¯´ï¼Œå¸Œæœ›æˆ‘èƒ½ç•™ä¸‹ã€‚å°±ä¸€ç›´åšåˆ°äº†å¹´åº•ã€‚10æœˆä»½å…¬å¸è¢«æ”¶è´­ï¼Œæ–°è€æ¿å‘äº†ä¸¤æ‹¨ç¦åˆ©ä¹‹åŽï¼Œå¼€å§‹æ‹–æ¬ å·¥èµ„ã€‚ç»ˆäºŽåœ¨18å¹´å¼€å¹´ï¼Œæºå¸¦è€…ç ´æ¡Œæ¤…è·‘è·¯äº†ã€‚ - -!è¦æ˜¯æˆ‘é€‰çš„è¯ï¼Œå¯èƒ½åªä¼šä¿®æ”¹ä¸€ä¸‹å…¬å¸çš„æ‰˜ç®¡æœåŠ¡å™¨ç®¡ç†å‘˜èº«ä»½è¿˜æœ‰å¯†ç ã€‚æ€»è€Œè¨€ä¹‹ä¸å¤ªé¡ºåˆ©ï¼ŒæœŸæœ›æ¥å¹´ä¸ç®¡å®žåœ¨æŠ€æœ¯ä¸Šè¿˜æ˜¯ç”Ÿæ´»ä¸Šæ›´ä¸ºé¡ºåˆ©ã€‚]]></content>
      <tags>
        <tag>17å¹´</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[release Win10]]></title>
    <url>%2F2017%2F09%2F17%2Frelease-Win10%2F</url>
    <content type="text"><![CDATA[å…è´¹æ´»åŠ¨ä»Šå¤©å¥½å‹è¯´æœ‰ä¸€ä¸ªé€çš®è‚¤çš„æ´»åŠ¨ã€‚å¯ä»¥è‡ªå·±åŽ»å°è¯•åˆ·ä¸€æ³¢å…è´¹çš„æ°¸ä¹…çš®è‚¤ã€‚æ­£é€¢å‘¨æœ«ï¼Œé—²æ¥æ— äº‹ã€‚æ‰“æ‰“æ¸¸æˆä¹Ÿæ˜¯ç§æ¶ˆé£ï¼Œæ‰“å¼€ç”µè„‘ã€‚æ‰æƒ³èµ·ï¼Œå‰äº›å¤©è²Œä¼¼æ— æ³•è¿žæŽ¥wifiäº†ï¼Œå½“æ—¶æ‡’å¾—ç†å°±æ²¡æœ‰æ”¶æ‹¾å®ƒã€‚ä»Šå¤©æ‰“å¼€ä¸€çœ‹ï¼Œå“Ÿï¼Œå¥½å¥½åœ°ã€‚å•¥äº‹æ²¡æœ‰ã€‚è¿˜æ˜¯è›®å¼€å¿ƒçš„ã€‚ è‰°éš¾çš„æ¸¸æˆä¹ æƒ¯çš„å¡é¡¿è¿›å…¥æ¸¸æˆï¼ŒåŠ ä¸Šç½‘é€Ÿæœ¬èº«ä¸ç»™åŠ›ã€‚æ¸¸æˆçŽ©çš„ç”šæ˜¯æ¼ç«ï¼Œæ‰“äº†ä¸€æŠŠæˆ‘è§‰å¾—æˆ‘çš„èƒƒæ¶²å¼€å§‹â€œç¿»è…¾äº†â€ã€‚éšå³ä¸åœ¨å®Œäº†ã€‚ å¤§ä½¬çš„Blogæ™šä¸Šçœ‹åˆ°å¤§ä½¬çš„å¾®åšæ›´æ–°äº†Ubuntu 16.04æ›´æ–°BBRçš„æ–‡ç« ï¼Œä¸æ˜Žè§‰åŽ‰ã€‚éšé€åœ¨è¯¥æœ¬æœ¬çš„è™šæ‹Ÿæœºä¸Šï¼Œå¼€å§‹æžèµ·æ¥ã€‚ç„¶åŽ~Ubuntuèµ·æ¥çš„äº†ã€‚è¯¥ç”µè„‘çš„èœå•èµ·ä¸æ¥äº†~ã€‚æ­¤åˆ»æˆ‘è§‰å¾—æˆ‘çš„èƒƒæ¶²å·²ç»å¿«åˆ°æˆ‘çš„å¿ƒå£äº†ã€‚ã€‚ã€‚ä¸ºäº†è‡ªå·±å£°æ˜Žå®‰å…¨è¿˜æ˜¯å…³æœºï¼Œæ”¾åœ¨ä¸€æ—åƒç°å§ã€‚ å½’å±žæ·±åˆ»çš„è§‰å¾—ï¼Œæ­¤åˆ»äºŽæ­¤æ“ä½œç³»ç»Ÿï¼Œæ­¤ç”µè„‘ä¸é€‚åˆç•™åœ¨æˆ‘çš„èº«è¾¹ã€‚æƒ³æƒ³è¿˜æ˜¯æ•´ç†ä¸€ä¸‹ï¼Œç»™è€çˆ¸ç•™ç€æ‰“æ‰“æ‰‘å…‹å¥½äº†ã€‚ ç¥æ„¿å¦‚æžœæœ‰æ¥ä¸–ï¼Œå¸Œæœ›åˆ«å†æœ‰è¿™ä¹ˆæ¶å¿ƒçš„æ“ä½œç³»ç»Ÿã€‚]]></content>
      <categories>
        <category>System</category>
      </categories>
      <tags>
        <tag>CHI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CoreAnimation-åŸºç¡€è¡¥å……]]></title>
    <url>%2F2017%2F07%2F18%2FCoreAnimation-%E5%9F%BA%E7%A1%80%E8%A1%A5%E5%85%85%2F</url>
    <content type="text"><![CDATA[å›¾å±‚æ ‘åœ¨UIKitä¸­æ‰€æœ‰çš„è§†å›¾éƒ½æ˜¯åŸºäºŽUIViewæ´¾ç”Ÿè€Œæ¥ï¼ŒUIViewæ”¯æŒè§¦æ‘¸æ—¶é—´ï¼Œå¯ä»¥æ”¯æŒåŸºäºŽCoreGraphicsç»˜å›¾ï¼Œå¯ä»¥åšä»¿å°„å˜æ¢ï¼ˆä¾‹å¦‚ï¼šæ—‹è½¬æˆ–ç¼©å°ï¼‰ï¼Œæˆ–è€…ç®€å•çš„ç±»ä¼¼äºŽæ»‘åŠ¨æˆ–è€…æ¸å˜çš„åŠ¨ç”»ã€‚ UIViewå’ŒLayerçš„å…³ç³» CALayerç±»åœ¨æ¦‚å¿µä¸Šå’ŒUIViewç±»ä¼¼ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸€äº›è¢«å±‚çº§å…³ç³»æ ‘ç®¡ç†çš„çŸ©å½¢å—ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¯ä»¥åŒ…å«ä¸€äº›å†…å®¹ï¼ˆå›¾ç‰‡ã€æ–‡æœ¬æˆ–è€…èƒŒæ™¯è‰²ï¼‰ï¼Œç®¡ç†å­è§†å›¾å±‚çš„ä½ç½®ã€‚ä¹Ÿæœ‰ä¸€äº›æ”¾å’Œå±žæ€§ç”¨æ¥åŠ¨ç”»ä¾¿å‡½ã€‚å’ŒUIViewæœ€å¤§çš„ä¸åŒå°±æ˜¯CALayerä¸å¤„ç†ç”¨æˆ·äº¤äº’æ—¶é—´ã€‚ CALyerå¹¶ä¸å¤„ç†å…·ä½“çš„å“åº”äº‹ä»¶ï¼ˆiOSé€šè¿‡è§†å›¾å±‚å…³ç³»æ¥ä¼ é€’è§¦æ‘¸äº‹ä»¶çš„æœºåˆ¶ï¼‰ï¼ŒäºŽæ˜¯å®ƒå¹¶ä¸èƒ½å¤Ÿå“åº”äº‹ä»¶ï¼Œå³ä½¿å®ƒæä¾›äº†ä¸€äº›å‡ºç‚¹åœ¨å›¾å±‚çš„èŒƒå›´ä¹‹å†…ã€‚ å¹³è¡Œçš„å±‚çº§å…³ç³» æ¯ä¸€ä¸ªUIViewéƒ½æœ‰ä¸€ä¸ªCALayerç¤ºä¾‹çš„å›¾å±‚å±žæ€§ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„backing layerï¼Œè§†å›¾çš„èŒè´£å°±æ˜¯åˆ›å»ºå¹¶ç®¡ç†è¿™ä¸ªå›¾å±‚ï¼Œä»¥ç¡®ä¿å½“å‰é©¶å…¥åœ¨å±‚çº§å…³ç³»ä¸­æ·»åŠ æˆ–è¢«ç§»é™¤æ—¶ï¼Œä»–ä»¬å…³è”çš„å›¾å±‚åœ¨å±‚çº§å…³ç³»ä¸­ä¹Ÿæœ‰ç›¸åŒçš„æ“ä½œã€‚ å®žé™…ä¸Šè¿™äº›èƒŒåŽå…³è”çš„å›¾å±‚æ‰æ˜¯çœŸæ­£ç”¨æ¥åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå’ŒåšåŠ¨ç”»ï¼ŒUIViewä»…ä»…æ˜¯å¯¹Layerçš„ä¸€ä¸ªå°è£…ï¼Œæä¾›åŸºäºŽè§¦æ‘¸äº‹ä»¶çš„å…·ä½“åŠŸèƒ½ï¼Œä»¥åŠCore Animationåº•å±‚æ–¹æ³•çš„é«˜çº§æŽ¥å£ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆiOSè¦åŸºäºŽUIVIewå’ŒCALayeræä¾›ä¸¤ä¸ªå¹³è¡Œçš„å±‚çº§å…³ç³»å‘¢ï¼Œä¸ºä»€ä¹ˆä¸ç”¨ä¸€ä¸ªç®€å•çš„å±‚çº§æ¥å¤„ç†æ‰€æœ‰çš„äº‹æƒ…å‘¢ï¼ŸåŽŸå› åœ¨äºŽè¦åšåˆ°èŒè´£åˆ†ç¦»ï¼Œè¿™æ ·æ‰èƒ½é¿å…å¾ˆå¤šçš„ä»£ç é‡å¤ã€‚åœ¨iOSå’ŒMAC OSä¸¤ä¸ªå¹³å°ä¸Šï¼Œæ—¶é—´å’Œç”¨æˆ·äº¤äº’çš„å¾ˆå¤šåœ°æ–¹ä¸åŒï¼ŒåŸºäºŽå¤šç‚¹è§¦æŽ§çš„ç”¨æˆ·å’ŒåŸºäºŽé¼ æ ‡é”®ç›˜æœ‰ç€æœ¬è´¨çš„åŒºåˆ«ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆiOSæœ‰UIKitå’ŒUIViewï¼Œä½†MAC OSæœ‰AppKitå’ŒNSViewçš„åŽŸå› ï¼Œä»–ä»¬åœ¨åŠŸèƒ½ä¸Šç›¸ä¼¼ï¼Œä½†æ˜¯åœ¨å®žé™…ä¸Šæœ‰ç€æ˜¾è‘—çš„åŒºåˆ«ã€‚ ç»˜å›¾ã€å¸ƒå±€å’ŒåŠ¨ç”»ï¼Œç›¸æ¯”ä¹‹ä¸‹å°±æ˜¯ç±»ä¼¼MAC bookå’Œæ¡Œé¢çº§ç³»åˆ—ä¸€æ ·åº”ç”¨äºŽiPhoneå’ŒiPadè§¦å±çš„æ¦‚å¿µã€‚æŠŠè¿™ç§åŠŸèƒ½çš„é€»è¾‘åˆ†å¡å¹¶åº”ç”¨åˆ°ç‹¬ç«‹çš„Core Animationæ¡†æž¶ï¼Œè‹¹æžœèƒ½å¤Ÿåœ¨iOSå’ŒMac OSä¹‹é—´å…±äº«ä»£ç ï¼Œæ˜¯çš„å¯¹è‹¹æžœè‡ªå·±çš„OSå¼€å‘å›¢é˜Ÿå’Œç¬¬ä¸‰æ–¹å¼€å‘è€…åŽ»å¼€å‘è¿™ä¸¤ä¸ªå¹³å°çš„åº”ç”¨æ›´åŠ ä¾¿æ·ã€‚ å®žé™…ä¸Šï¼Œè¿™é‡Œå¹¶ä¸æ˜¯ä¸¤ä¸ªå±‚çº§å…³ç³»ï¼Œè€Œæ˜¯å››ä¸ªï¼Œæ¯ä¸€ä¸ªéƒ½æ‰®æ¼”ç€ä¸åŒçš„è§’è‰²ï¼Œé™¤äº†è§†å›¾å±‚çº§å’Œå›¾å±‚æ ‘ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨å‘ˆçŽ°æ ‘å’Œæ¸²æŸ“æ ‘ã€‚ å›¾å±‚çš„èƒ½åŠ› å¦‚æžœè¯´CALayeræ˜¯UIViewå†…éƒ¨å®žçŽ°çš„ç»†èŠ‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦äº†è§£å®ƒå‘¢ï¼Ÿè‹¹æžœå½“ç„¶ä¸ºæˆ‘ä»¬æä¾›äº†æ›´åŠ è¡—çš„UIViewæŽ¥å£ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å°±æ²¡å¿…è¦ç›´æŽ¥åŽ»å¤„ç†Core Animationçš„ç»†èŠ‚äº†å‘¢ï¼Ÿ æŸç§æ„ä¹‰ä¸Šæ˜¯çš„ï¼Œå¯¹äºŽä¸€äº›ç®€å•çš„éœ€æ±‚æ¥è¯´ï¼Œæˆ‘ä»¬ç¡®å®žæ²¡æœ‰å¿…è¦å¤„ç†CALayerï¼Œå› ä¸ºè‹¹æžœå·²ç»é€šè¿‡UIViewçš„é«˜çº§APIé—´æŽ¥çš„ä½¿å¾—åŠ¨ç”»å˜çš„æ›´ç®€å•ã€‚ ä½†æ˜¯è¿™ç§ç®€å•ä¼šä¸å¯ä¾¿é¢çš„é€ æˆä¸€äº›çµæ´»æ€§ä¸Šçš„ç¼ºå¤±ï¼Œæˆ‘ä»¬è¦åœ¨åº•å±‚å®žçŽ°ä¸€äº›æ”¹å˜ï¼Œæˆ–è€…ä½¿ç”¨ä¸€äº›è‹¹æžœæ²¡æœ‰åœ¨UIViewä¸Šå®žçŽ°çš„æŽ¥å£åŠŸèƒ½ï¼Œè¿™æ˜¯é™¤äº†ä»‹å…¥Core Animationåº•å±‚ä¹‹å¤–åˆ«æ— é€‰æ‹©ã€‚ æˆ‘ä»¬å·²ç»æ­£å¼äº†å›¾å±‚ä¸èƒ½åƒè§†å›¾é‚£æ ·å¤„ç†è§¦æ‘¸äº‹ä»¶ï¼Œé‚£ä¹ˆä»–èƒ½åšå“ªäº›è§†å›¾ä¸èƒ½åšçš„ï¼Ÿè¿™é‡Œæœ‰ä»¥ä¸‹UIViewæ²¡æœ‰æš´éœ²çš„å‡ºæ¥çš„CALayerçš„åŠŸèƒ½: é˜´å½±ï¼Œåœ†è§’ï¼Œå¸¦è‰²è¾¹æ¡† 3Då˜æ¢ éžçŸ©å½¢èŒƒå›´ é€æ˜Žé®ç½© å¤šçº§éžçº¿æ€§åŠ¨ç”» ä½¿ç”¨å›¾å±‚é¦–å…ˆä½¿ç”¨ä¸€äº›layerçš„å±žæ€§ã€‚åˆ›å»ºä¸€ä¸ªçŸ©å½¢åœ¨å±å¹•ä¸Šï¼Œè°ƒæ•´é¢œè‰²ä½¿å…¶ä¸Žåº•è‰²å¯ä»¥åŒºåˆ†å¼€ã€‚ç§°å…¶ä¸ºlayerViewï¼ˆä½¿ç”¨è¶…è¿‡8.2åˆ™å¯å¿½ç•¥ï¼‰ä¸ºlayerViewæ·»åŠ ä¸€ä¸ªå­å›¾å±‚ï¼Œé™¤äº†åˆ›å»ºä¸€ä¸ªå­æŽ§ä»¶å¤–ä¹Ÿå¯ä»¥åˆ›å»ºCALayerå†æ·»åŠ åˆ°layerViewçš„å­å›¾å±‚ã€‚å°½ç®¡UIViewæš´éœ²äº†å›¾å±‚çš„å±žæ€§ï¼Œä½†æ˜¯æ ‡å‡†çš„Xcodeçš„æ¨¡æ¿å¹¶æ²¡æœ‰åŒ…å«Core Animationç›¸å…³å¤´æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦æ·»åŠ QuarzCoreæ¡†æž¶ï¼Œå¹¶å¼•è¿›å¤´æ–‡ä»¶ã€‚ä»£ç  12345678910111213CALayer *subLayer = (&#123; CALayer * layer = [CALayer layer]; layer.frame = CGRectMake(100, 100, 25, 25); layer.backgroundColor = [UIColor blueColor].CGColor; layer; &#125;); [layerView.layer addSublayer:subLayer]; ä¸€ä¸ªè§†å›¾åªæœ‰ä¸€ä¸ªç›¸å…³å›¾å±‚ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰ï¼ŒåŒæ—¶è§†å›¾ä¹Ÿæ”¯æŒæ·»åŠ å¤šä¸ªå­å›¾å±‚ã€‚ä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ã€‚å•çº¯çš„å¤„ç†å›¾å±‚å¯¹è±¡ï¼Œè€Œä¸æ˜¯éœ€è¦æ·»åŠ é¢å¤–çš„å­å›¾å±‚ã€‚ åœ¨Mac OSå¹³å°ä¸Šï¼Œä¸€ä¸ªæ€§èƒ½çš„ç¼ºé™·å°±æ˜¯ç”±äºŽç”¨äº†è§†å›¾å±‚çº§è€Œä¸æ˜¯å•ç‹¬åœ¨ä¸€ä¸ªè§†å›¾å†…ä½¿ç”¨CALayeræ ‘çŠ¶å±‚çº§ã€‚ä½†æ˜¯åœ¨iOSå¹³å°ä¸Šï¼Œä½¿ç”¨è½»é‡çº§çš„UIViewç±»æ²¡æœ‰æœ‰æ˜¾è‘—çš„æ€§èƒ½å½±å“ã€‚ï¼ˆ10.8ä¹‹åŽNSViewçš„æ€§èƒ½åŒæ ·å¾—åˆ°äº†æå‡ï¼‰ ä½¿ç”¨å›¾å±‚å…³è”çš„è§†å›¾è‹¥ä¸æ˜¯CALayerçš„å¥½å¤„åœ¨äºŽï¼Œæ‚¨èƒ½åœ¨ä½¿ç”¨æ‰€æœ‰CALayeråº•å±‚ç‰¹æ€§çš„åŒäº‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨UIViewçš„é«˜çº§APIã€‚ ä½†å‡ºçŽ°ä¸‹é¢çŠ¶å†µæ˜¯å°±éœ€è¦æ“ä½œCALayer å¼€å‘åŒæ—¶å¯ä»¥åœ¨Mac OSä¸Šè¿›è¡Œçš„è·¨å¹³å°åº”ç”¨ ä½¿ç”¨å¤šç§CALayerçš„å­ç±» åšä¸€äº›å¯¹æ€§èƒ½ç‰¹åˆ«æŒ‘å‰”çš„å·¥ä½œæ€»ä½“è€Œè¨€ç›¸å¯¹è¾ƒå°‘ï¼Œå¤„ç†è§†å›¾ä¼šæ¯”è¾ƒç®€å•ã€‚ å¯„å®¿å›¾ å›¾ç‰‡èƒœè¿‡åƒè¨€ä¸‡è¯­ï¼Œç•Œé¢æŠµå¾—è¿‡ä¸Šå‰å›¾ç‰‡ contentså±žæ€§CALayerçš„ä¸€ä¸ªå±žæ€§ï¼Œç±»åž‹æ˜¯idï¼ˆå› ä¸ºåœ¨MacOSä¸Šå¯ä»¥æŽ¥æ”¶CGImageæˆ–NSImageï¼‰ã€‚å®žé™…ä¸ŠæŽ¥å—çš„CGImageRefå¯¹è±¡ï¼Œå› æ­¤åœ¨ARCçŽ¯å¢ƒä¸‹éœ€ä½¿ç”¨(__bridge id)è¿›è¡Œæ¡¥æŽ¥ï¼ˆå½“ç„¶MRCä¸ç”¨ï¼‰ã€‚ 1layer.contents = (__bridge id)image.CGImage; contentGravityUIViewçš„contentModeå±žæ€§ï¼ŒæŽ¥å—NSIntegerç±»åž‹æ•°æ®ï¼Œè°ƒæ•´å¯„å®¿å›¾å¡«å……æ–¹å¼ã€‚å…·ä½“ç±»åž‹å¦‚ä¸‹ï¼š UIViewContentModeScaleToFill, UIViewContentModeScaleAspectFit, // contents scaled to fit with fixed aspect. remainder is transparent UIViewContentModeScaleAspectFill, // contents scaled to fill with fixed aspect. some portion of content may be clipped. UIViewContentModeRedraw, // redraw on bounds change (calls -setNeedsDisplay) UIViewContentModeCenter, // contents remain same size. positioned adjusted. UIViewContentModeTop, UIViewContentModeBottom, UIViewContentModeLeft, UIViewContentModeRight, UIViewContentModeTopLeft, UIViewContentModeTopRight, UIViewContentModeBottomLeft, UIViewContentModeBottomRight, CALayerä¸Žä¹‹ç›¸å¯¹åº”çš„å±žæ€§æ˜¯ContentGravityï¼ŒæŽ¥å—NSStringç±»åž‹ã€‚å…·ä½“ç±»åž‹å¦‚ä¸‹ kCAGravityCenter kCAGravityTop kCAGravityBottom kCAGravityLeft kCAGravityRight kCAGravityTopLeft kCAGravityTopRight kCAGravityBottomLeft kCAGravityBottomRight kCAGravityResize kCAGravityResizeAspect kCAGravityResizeAspectFill contentScaleCALayerä¸­ç”¨äºŽè¡¨ç¤ºå±å¹•ä¸€ä¸ªç‚¹ç»˜åˆ¶å‡ ä¸ªåƒç´ ï¼Œé€‚ç”¨äºŽé«˜åˆ†è¾¨çŽ‡å±å¹•ï¼ˆRetinaï¼‰ã€‚å¦‚æžœè®¾ç½®contentsModeä¸ºæ‹‰ä¼¸åˆ™ä¸ä¼šèµ·æ•ˆï¼Œå•çº¯è®¾ç½®å¯¹é½æ–¹å¼æ—¶ä¼šå¯¹å¯„å®¿å›¾çš„æ˜¾ç¤ºæœ‰å¾ˆå¤§å½±å“ã€‚ UIViewå¯¹åº”å±žæ€§ä¸ºcontentsScaleFactor maskToBoundsCALyerç”¨äºŽåˆ‡å‰²è¶…å‡ºè¾¹ç•Œçš„éƒ¨åˆ†ï¼ŒæŽ¥æ”¶BOOLç±»åž‹æ•°æ®ã€‚ UIViewä¸Žä¹‹å¯¹åº”çš„å±žæ€§æ˜¯clipsToBoundsã€‚ contentsReckCALayerç”¨äºŽè¡¨ç¤ºç»˜åˆ¶å¯„å®¿å›¾çš„åŒºåŸŸï¼ŒæŽ¥å—CGRectï¼Œå±žäºŽå•ä½åæ ‡ï¼Œåœ¨iOSä¸­ä¸€å…±æœ‰æ˜¯é‚£ç§åæ ‡ï¼š ç‚¹ â€” æœ€å¸¸ä½¿ç”¨çš„åæ ‡ç³»ã€‚ä½¿ç”¨ç‚¹ä½œä¸ºåŸºç¡€å•ä½ï¼Œä¹Ÿè¢«æˆä¸ºé€»è¾‘åƒç´ ã€‚æ ‡å‡†å°ºå¯¸é‡Œé¢ä¸€ä¸ªç‚¹å°±æ˜¯ä¸€ä¸ªåƒç´ ï¼ŒRetainä¸­ä¸€ä¸ªç‚¹äº‹2*2ä¸ªåƒç´ ã€‚iOSå¼•å…¥ç‚¹æ˜¯ä¸ºäº†åœ¨ä¸åŒåˆ†è¾¨çŽ‡çš„è®¾å¤‡ä¸Šè¾¾åˆ°ç›¸åŒçš„æ˜¾ç¤ºæ•ˆæžœã€‚ åƒç´  â€” ç‰©ç†åƒç´ ï¼Œä¸ä¼šç”¨æ¥å¸ƒå±€ï¼Œä»ä¸Žå›¾ç‰‡ç›¸å¯¹ã€‚UIImageå°±æ˜¯ä¸€ä¸ªå±å¹•è§£å†³æ–¹æ¡ˆï¼Œç”¨ç‚¹æ¥æ¥åº¦é‡å¤§å°ã€‚ä½†åº•å±‚çš„CGImageä»æ˜¯ç”¨åƒç´ è¡¨ç¤ºçš„ã€‚ å•ä½ â€” å¯¹äºŽå›¾ç‰‡å¤§å°æˆ–å›¾å±‚è¾¹ç•Œçš„æ˜¾ç¤ºï¼Œå½“å¤§å°æ”¹å˜ä¸éœ€è¦å†æ¬¡è°ƒæ•´ã€‚åœ¨OpenGLå’ŒCoreAnimationä¸­ä½¿ç”¨è¾ƒå¤šã€‚ é»˜è®¤å€¼æ˜¯{0,0,1,1}ï¼Œæ„å‘³ç€æ•´ä¸ªå›¾å±‚éƒ½æ˜¯å¯è§çš„ã€‚å¦‚æžœè®¾ç½®åŽŸç‚¹æˆä¸ºèµ‹å€¼æˆ–è¾¹ç•Œå¤§äºŽ1åˆ™ä¼šæŠŠå¤–ç•Œçš„åƒç´ æ‹‰è¿›å›¾å±‚å¡«å……ä½™ä¸‹åŒºåŸŸã€‚ contentsCenterç±»åž‹CGRectï¼Œå®šä¹‰äº†ä¸€ä¸ªå›ºå®šçš„è¾¹æ¡†å’Œå›¾å±‚ä¸Šçš„å¯æ‹‰ä¼¸åŒºåŸŸã€‚æ”¹å˜è¿™ä¸ªåŒºåŸŸçš„å€¼æ—¶ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå½“è§†å›¾çš„å¤§å°æ”¹å˜æ˜¯æ‰ä¼šçŽ°è±¡å‡ºæ¥ã€‚ ä¸ŽUIImageçš„resizableImageWithCapIntsets:ç±»ä¼¼ã€‚ æ¯”è¾ƒæ–¹ä¾¿çš„æ˜¯ï¼Œåœ¨Interface Builderçª—å£æœ‰å¯¹åº”çš„å±žæ€§å€¼ï¼Œå³Stretchingè®¾ç½®ã€‚ Custom Drawingè®¾ç½®CALayerçš„contentså±žæ€§å¹¶ä¸æ˜¯åˆ›å»ºå¯„å®¿å›¾çš„å”¯ä¸€æ–¹æ³•ã€‚ä»æœ‰åŽ»å¦‚ä¸‹æ–¹æ³•å¯ä»¥ç»˜åˆ¶å¯„å®¿å›¾ã€‚ -drawRect: æ–¹æ³• å¦‚æžœéžå¿…é¡»åˆ™ä¸è¦å®žçŽ°è¯¥æ–¹æ³•ï¼Œå› ä¸ºViewä¼šåœ¨è°ƒç”¨è¯¥æ–¹æ³•æ—¶ä¸ºè§†å›¾åˆ›å»ºä¸€ä¸ªå¯„å®¿å›¾ã€‚åœ¨è¯¥æ–¹æ³•ä¸­å¯ä»¥ä½¿ç”¨Core Graphics ç»˜åˆ¶å¯„å®¿å›¾ï¼Œè™½ç„¶æ˜¯UIViewçš„æ–¹æ³•ï¼Œä½†å®žé™…ç»˜åˆ¶å¯„å®¿å›¾çš„è¿˜æ˜¯ç”±CALayerç»˜åˆ¶å¹¶ä¿å­˜çš„ã€‚ -displayLayer:(CALayer*) CALayerçš„delegateæ–¹æ³•ï¼Œå¯ä»¥ç”¨ä¸Žç›´æŽ¥å¯¹CALayerè¿›è¡Œæ“ä½œï¼Œç±»ä¼¼ç»˜åˆ¶contentså±žæ€§ç­‰ã€‚ å¦‚æžœæ²¡æœªè°ƒç”¨ä¸Šè¿°æ–¹æ³•åˆ™è°ƒç”¨ -displayLayer:(CALayer) inContext:(CGContextRef) åœ¨è°ƒç”¨ä¸Šé¢çš„æ–¹æ³•å‰ï¼ŒCALayerä¼šåˆ›å»ºä¸€ä¸ªå°ºå¯¸åˆé€‚çš„å¯„å®¿å›¾ï¼Œå¹¶åˆ›å»ºå›¾å½¢ä¸Šä¸‹æ–‡å¹¶ä¼ å…¥ä»£ç†æ–¹æ³•ã€‚ å½“çŽ°å®žçš„è°ƒç”¨displayå‘½ä»¤æ—¶ï¼ŒCALayerå¹¶ä¸ä¼šè‡ªåŠ¨ç»˜åˆ¶ï¼Œè€Œæ˜¯äº¤ç”±å¼€å‘è€…å†³å®šã€‚ è™½ç„¶æ²¡æœ‰è®¾ç½®maskToBoundså±žæ€§ï¼Œä½†åœ¨ç»˜åˆ¶CALayeræ—¶ä»ä¸ä¼šè¶…å‡ºä¾¿æ·ç»˜åˆ¶ã€‚ ä¸€èˆ¬ä¸éœ€è¦å½“åˆå¤„ç†CALayerä»£ç†ï¼Œå› ä¸ºåœ¨åˆ›å»ºUIViewæ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºCALayerå¹¶ä»£ç†è®¾ç½®ç»™UIViewã€‚å½“éœ€è¦ç»˜åˆ¶å¯„å®¿å›¾æ—¶ï¼Œå¯ä»¥é€šè¿‡UIViewçš„drawRectï¼šæ–¹æ³•è¿›è¡Œç»˜åˆ¶å³å¯ã€‚ å›¾å±‚å‡ ä½•å­¦ å¸ƒå±€UIViewä¸»è¦çš„ä¸‰ç§å¸ƒå±€å±žæ€§:frame,boundså’Œcenterã€‚CALayerä¸Žä¹‹å¯¹åº”çš„å±žæ€§ä¸ºframe,boundså’Œpositionã€‚å…¶ä¸­centerå’Œpositionå±žæ€§æ˜¯é’ˆå¯¹äºŽçˆ¶å›¾å±‚çš„anchorPiontæ‰€åœ¨çš„ä½ç½®ã€‚ åœ¨æ“ä½œUIViewçš„frameã€boundså’Œcenterå±žæ€§æ—¶ï¼Œå®žé™…ä¸Šå¯¹åº”ä¿®æ”¹çš„æ˜¯CALayerçš„å±žæ€§ã€‚ frameæ˜¯ä¸€ä¸ªè™šæ‹Ÿå±žæ€§ï¼Œæ˜¯æ ¹æ®boundsã€positionå’Œtransformè®¡ç®—å‡ºæ¥çš„ï¼Œä¿®æ”¹frameæ˜¯å¯¹åº”ä¿®æ”¹å…¶ä»–å€¼ï¼Œä¿®æ”¹å…¶ä»–å€¼æ—¶ä¼šå½±å“frameã€‚å½“frameè¿›è¡Œäº†å˜æ¢ä¹‹åŽï¼Œframeçš„å®½é«˜å¯¹åº”å˜æ¢ä¹‹åŽçš„å®½é«˜ï¼Œè¿™æ—¶boundsçš„å®½é«˜ä¸Žframeçš„å®½é«˜å°±ä¸åœ¨ä¸€æ ·äº†ã€‚è§†å›¾çš„centerå’Œpositionå±žæ€§æŒ‡å®šäº†anchorPointç›¸å¯¹äºŽçˆ¶è§†å›¾çš„ä½ç½®ã€‚å›¾å±‚çš„anchorPointé€šè¿‡positionæ¥æŽ§åˆ¶frameçš„ä½ç½®ï¼Œå¯ä»¥è®¤ä¸ºanchorPointæ˜¯ä¸€å®šçš„æŠŠæŸ„ã€‚ é»˜è®¤anchorPointåœ¨å›¾å±‚ä¸­é—´ï¼Œè¿™ä¹Ÿæ˜¯UIViewæŠŠpositionå¯¹åº”centerå±žæ€§çš„åŽŸå› ã€‚ä½†å›¾å±‚çš„anchorPointå¯ä»¥è¢«ç§»åŠ¨ã€‚ å’ŒcontentReckä¸ŽcontentCenterå±žæ€§ç±»ä¼¼ï¼ŒanchorPointä¹Ÿæ˜¯å•ä½åæ ‡ã€‚é»˜è®¤å€¼æ˜¯{0.5,0.5}ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨å›¾å±‚ä¹‹å¤–ã€‚ åæ ‡ç³»å’Œè§†å›¾ä¸€æ ·ï¼Œå›¾å±‚åœ¨å›¾å±‚æ ‘ä¸­ä¹Ÿæ˜¯ç›¸å¯¹äºŽçˆ¶å›¾å±‚æŒ‰å±‚çº§å…³ç³»æ”¾ç½®ï¼Œä¸€ä¸ªå›¾å±‚çš„positionä¾èµ–äºŽä»–çˆ¶å›¾å±‚çš„boundsï¼Œå¦‚æžœçˆ¶å›¾å±‚å‘ç”Ÿç§»åŠ¨å­å›¾å±‚ä¹Ÿä¼šè·Ÿç€ç§»åŠ¨ã€‚ è¿™æ ·çš„å±‚çº§å…³ç³»å½“å¤„ç†æ•´ä½“ç§»åŠ¨æ—¶ï¼Œç›¸å½“éåŽ†ã€‚ä½†å½“éœ€è¦çŸ¥é“ä¸€ä¸ªå›¾å±‚ç›¸å¯¹äºŽå¦ä¸€ä¸ªå›¾å±‚çš„ç›¸å¯¹æˆ–ç»å¯¹ä½ç½®æ—¶ï¼ŒCALayeræä¾›äº†è½¬æ¢å·¥å…·æ–¹æ³•ã€‚ -(CGPoint)convertPoint:(CGPoint) fromLayer:(CALayer*) -(CGPoint)converPoint:(CGPoint) toLayer:(CALayer*) -(CGRect)converRect:(CGRect) fromLayer:(CALayer*) -(CGRect)converRect:(CGRect) toLayer:(CALayer*) è¿™äº›æ–¹æ³•ç”¨äºŽå°†æŒ‡å®šå›¾å±‚ä¸‹çš„ç‚¹æˆ–åŒºåŸŸè½¬æ¢æˆå¦ä¸€ä¸ªå›¾å±‚ä¸‹çš„ç‚¹æˆ–åŒºåŸŸ ç¿»è½¬çš„å‡ ä½•ç»“æž„é€šå¸¸ï¼Œåœ¨iOSä¸Špositionä½ä¸Žçˆ¶å›¾å±‚çš„å·¦ä¸Šè§’ï¼Œè€ŒMACä½äºŽå·¦ä¸‹è§’ã€‚Core Animationé€šè¿‡geometryFlippedå±žæ€§æ¥é€‚é…è¿™ç§æƒ…å†µï¼Œå†³å®šæ˜¯å¦ç›¸å¯¹äºŽçˆ¶è§†å›¾åž‚ç›´ç¿»è½¬ã€‚å¦‚æžœåœ¨iOSä¸Šè®¾ç½®ä¸ºYESï¼Œåˆ™ä¼šå¯¼è‡´è¯¥è§†å›¾çš„æ‰€æœ‰å­è§†å›¾ï¼Œéƒ½ä¼šä»¥åº•éƒ¨æŽ’ç‰ˆè€Œä¸æ˜¯é¡¶éƒ¨æŽ’ç‰ˆã€‚ Zåæ ‡è½´ä¸ŽUIViewä¸¥æ ¼çš„äºŒç»´åæ ‡ä¸åŒï¼ŒCALayerå­˜åœ¨äºŽä¸‰ç»´ç©ºé—´ä¸­ï¼ŒCALayerçš„å¦å¤–2ä¸ªå±žæ€§ï¼ŒzPositionå’ŒanchorPointZéƒ½æ˜¯åœ¨Zè½´ä¸Šæè¿°ä½ç½®çš„æµ®ç‚¹æ•°ã€‚ zPositionå¹¶ä¸å¸¸ç”¨ï¼Œé™¤äº†å˜æ¢ä¹‹å¤–ï¼Œæœ€å®žç”¨çš„åŠŸèƒ½å°±æ˜¯æ”¹å˜è§†å›¾çš„é¡ºåºã€‚ Hit Testingä¸å»ºè®®åˆ›å»ºç‹¬ç«‹çš„å›¾å±‚ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„åŽŸå› å°±æ˜¯ä¸ç”¨å¤„ç†é¢å¤–çš„å¤æ‚è§¦æ‘¸äº‹ä»¶ã€‚CALayerä¸€èˆ¬ä¸å¤„ç†å“åº”è€…é“¾äº‹ä»¶ï¼Œæ‰€ä»¥ä¸èƒ½å¤„ç†äº‹ä»¶æˆ–æ‰‹åŠ¿ã€‚ä½†è¿˜æ˜¯æä¾›äº†æ–¹æ³•ç”¨äºŽå¯èƒ½çš„éœ€æ±‚ -(BOOL)containtPoint:(CGPoint) -(CALayer*)hitTest:(CGPoint) containtPointå½“å‰å›¾å±‚æ˜¯å¦åŒ…å«è¯¥ç‚¹ï¼Œè€ŒhitTestç”¨äºŽè¯¥ç‚¹ååœ¨çš„CALayerå¯¹è±¡ã€‚ è‡ªåŠ¨å¸ƒå±€ä¸å»ºè®®åˆ›å»ºç‹¬ç«‹å›¾å±‚çš„å¦ä¸€ä¸ªåŽŸå› ï¼ŒCALayeråœ¨iOSä¸Šä¸èƒ½è‡ªåŠ¨é€‚é…ã€‚CALayerMangeråè®®å’ŒCAConstrainLayerMangerç±»ä»…é™MacOSï¼Œé‡å†™-layoutSublayerOfLayer:(CALayer*)æ–¹æ³•ï¼Œå½“è°ƒç”¨setNeedLayoutæ—¶ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œæ¥é‡æ–°å¸ƒå±€ã€‚ å› æ­¤å»ºè®®ä½¿ç”¨UIViewï¼ŒUIViewæä¾›äº†autoresizingMaskå’Œconstrainså±žæ€§æ¥ä½¿ç”¨å±å¹•æ—‹è½¬ã€‚ è§†è§‰æ•ˆæžœåœ†è§’CALayerçš„å±žæ€§connerRadiusæŽ§åˆ¶ç€åœ†è§’çš„æ›²çŽ‡ï¼ˆé»˜è®¤ä¸º0ï¼Œå³ç›´è§’ï¼‰ã€‚è¯¥å±žæ€§åªå½±å“èƒŒæ™¯é¢œè‰²ï¼Œä¸å½±å“å­å›¾å±‚å’ŒèƒŒæ™¯å›¾ï¼Œå½“è®¾ç½®masksToBoundsä¸ºYESæ˜¯ï¼Œå›¾å±‚å†…æ‰€æœ‰éƒ½ç³»éƒ½ä¼šè¢«æˆªå–ã€‚ å›¾å±‚è¾¹æ¡†CALayerçš„borderWidthå’ŒborderColorå±žæ€§ï¼Œå®šä¹‰äº†è¾¹æ¡†çš„ç»˜åˆ¶æ ·å¼ã€‚è¿™æ¡çº¿ä¼šæ²¿ç€å›¾å±‚çš„boundsç»˜åˆ¶ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬åœ†è§’ã€‚ borderColoræ˜¯CGColorRefç±»åž‹ï¼ŒéžCocoaå†…ç½®å¯¹è±¡ï¼Œè™½ç„¶åœ¨æŒæœ‰å’Œé‡Šæ”¾ä¸Šå’ŒNSObectç±»ä¼¼ï¼Œä½†æ˜¯åªèƒ½ä½¿ç”¨assginå£°æ˜Žã€‚è¾¹æ¡†æ˜¯è·Ÿéšç€å›¾å±‚è¾¹ç•Œå˜åŒ–çš„è€Œéžå›¾å±‚çš„å†…å®¹ã€‚ é˜´å½±shadowOpacityé˜´å½±ä¸å¯è§åº¦ï¼ˆé»˜è®¤æ˜¯æŒ‡0ï¼‰ï¼Œæ•°å€¼åœ¨0.0 ~ 1.0é—´çš„æµ®ç‚¹æ•°ã€‚å¦‚æžœè¦å¯¹é˜´å½±è¿›è¡Œç¼–è¾‘å¯ä»¥æ“ä½œ:shadowColorã€shadowOffsetã€shadowRadiuså’ŒshadowPathå››ä¸ªå±žæ€§ã€‚ shadowOffseté»˜è®¤å€¼æ˜¯{0,-3}ï¼Œæ‰€ä»¥é»˜è®¤é˜´å½±ä¼šå‘ä¸Šåç§»ã€‚ç”±äºŽCore Animationæ˜¯ä»Žå›¾å±‚å¥—è£…æ¼”å˜è€Œæ¥ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯iOSçš„ç§æœ‰åŠ¨ç”»æ¡†æž¶ï¼‰ï¼Œä½†ç¡®æ˜¯ç”±Macå…ˆé—®ä¸–çš„ã€‚ shadowRadiusæŽ§åˆ¶ç€é˜´å½±çš„æ¨¡ç³Šåº¦ï¼ˆé»˜è®¤å€¼0ï¼‰ï¼Œæ•°å€¼è¶Šå¤§é˜´å½±å’Œå›¾å±‚çš„è¾¹ç•Œå°±è¶Šä¸æ˜Žæ˜¾ã€‚ shadowPathæŽ§åˆ¶éšå½¢çš„å½¢çŠ¶ï¼Œæ˜¯ä¸€ä¸ªCGPathRefç±»åž‹ï¼Œå±žäºŽCore Graphicsæ¡†æž¶ã€‚ å›¾å±‚è’™æ¿å¯ä»¥é€šè¿‡masksToBoundsè£å‰ªå›¾å±‚ï¼Œå¯ä»¥é€šè¿‡borderCoorç­‰å±žæ€§æŽ§åˆ¶é˜´å½±ã€‚å¯ä»¥é€šè¿‡å›¾ç‰‡å±•ç¤ºå›¾å½¢ï¼Œä½†æ˜¯éƒ½ä¸èƒ½åŠ¨æ€çš„ç»˜åˆ¶ç”Ÿæˆå›¾å±‚è’™æ¿ï¼Œä¹Ÿä¸èƒ½è®©å­å›¾å±‚è¢«å‰ªè£æˆåŒæ ·çš„å½¢çŠ¶ã€‚ maskå±žæ€§ï¼Œç±»åž‹å°±æ˜¯CALayerï¼Œè‡´ä½¿çˆ¶å›¾å±‚æ ¹æ®maskçš„è½®å»“ç»˜åˆ¶ã€‚ å› ä¸ºæœ¬èº«æ˜¯åŠ¨æ€å±žæ€§ï¼Œå¯ä»¥è¢«åšæˆåŠ¨ç”»ã€‚ æ‹‰ä¼¸å’Œè¿‡æ»¤minificationFilterå’ŒmaginficationFilterå±žæ€§ã€‚æ€»çš„æ¥è¯´ï¼Œå½“æ˜¾ç¤ºä¸€ä¸ªå›¾ç‰‡çš„æ—¶å€™åº”è¯¥æ˜¯1:1ï¼Œå³ç­‰æ¯”æ˜¾ç¤ºã€‚åŽŸå› å¦‚ä¸‹ï¼š èƒ½å¤Ÿæ˜¾ç¤ºæ›´å¥½çš„ç”»è´¨ï¼Œåƒç´ æ²¡æœ‰è¢«åŽ‹ç¼©ä¹Ÿæ²¡æœ‰è¢«æ‹‰ä¼¸ã€‚ èƒ½æ›´å¥½çš„ä½¿ç”¨å†…å­˜ã€‚ ä¸æ¶ˆè€—CPUè¿›è¡Œé¢å¤–è®¡ç®—ã€‚ ä½†éœ€æ±‚å¯èƒ½éœ€è¦æˆ‘ä»¬æ˜¾ç¤ºä¸€å¼ ä¸æŒ‰ç…§æ¯”ä¾‹çš„å›¾ç‰‡ã€‚CALayeræä¾›äº†ä¸‰ç§æ‹‰ä¼¸è¿‡æ»¤æ–¹æ³•ï¼š kCAFilterLinear kCAFilterNearest kCAFilterTrilinear é»˜è®¤éƒ½æ˜¯kCAFilterLinearï¼Œè¿™ä¸ªæ–¹æ³•é‡‡ç”¨åŒçº¿æ€§çŽ‡æ³¢ç®—æ³•ã€‚ï¼ˆåŒçº¿æ€§æ»¤æ³¢ç®—æ³•é€šè¿‡å¯¹å¤šä¸ªåƒç´ é‡‡æ ·ï¼Œæœ€ç»ˆç”Ÿæˆæ–°çš„å€¼ï¼Œå¾—åˆ°ä¸€ä¸ªä¸é”™çš„æ‹‰ä¼¸ï¼‰ä½†æ˜¯ï¼Œå½“æ”¾å¤§å¤ªå¤šå€æ—¶å›¾ç‰‡å°±ä¼šæ¨¡ç³Šä¸æ¸…ã€‚ kCAFilterLinearå’ŒkCAFilterTrilinearéžå¸¸ç›¸ä¼¼ï¼Œå¤§éƒ¨åˆ†æ—¶å€™çœ‹ä¸å‡ºåŒºåˆ«ã€‚ï¼ˆä½†è¾ƒåŒçº¿æ€§æ»¤æ³¢è€Œè¨€ï¼Œä¸‰çº¿æ€§æ»¤æ³¢ç®—æ³•ï¼Œå­˜å‚¨äº†å¤šä¸ªå¤§å°æƒ…å†µä¸‹çš„å›¾ç‰‡ï¼Œå¹¶ä¸‰ç»´å–æ ·ï¼ŒåŒæ—¶ç»“åˆå¤§å›¾å’Œå°å›¾çš„å­˜å‚¨è¿›è€Œå¾—åˆ°æœ€åŽçš„ç»“æžœã€‚è¿™ä¸ªç®—æ³•çš„æœ‰ç‚¹åœ¨äºŽï¼Œåœ¨ä¸€ç³»åˆ—æŽ¥è¿‘æœ€åŽå¤§å°çš„å›¾ç‰‡ä¸­å–æ ·ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šæ›´å¤šåƒç´ åŒæ­¥å–æ ·ã€‚è¿™æ ·å­åšæé«˜äº†æ€§èƒ½ï¼Œä¹Ÿé¿å…äº†å› å°æ¦‚çŽ‡å–èˆé”™è¯¯å¼•èµ·çš„å–æ ·å¤±çµé—®é¢˜ï¼‰ã€‚ å¯¹äºŽå¤§å›¾æ¥è¯´ï¼ŒåŒçº¿æ€§æ»¤æ³¢å’Œä¸‰çº¿æ€§æ»¤æ³¢è¡¨çŽ°çš„æ›´å¥½ã€‚ kCAFilterNearestæ–¹æ³•ï¼Œå–æ ·å°±è¿‘åŽŸåˆ™ã€‚ä¼˜ç‚¹ï¼šå¾ˆå¿«ã€‚ç¼ºç‚¹ï¼šåŽ‹ç¼©å›¾ç‰‡æ•ˆæžœä¸å¥½ï¼Œæ–¹æ³•å›¾ç‰‡ä¼šå‡ºçŽ°é©¬èµ›å…‹æˆ–åƒç´ å—ã€‚ é’ˆå¯¹äºŽæ²¡æœ‰æ–œçº¿çš„å°å›¾æ¥è¯´ï¼Œæœ€è¿‘è¿‡æ»¤ç®—æ³•å¾ˆå¥½ æ€»ç»“ï¼šçº¿æ€§ç®—æ³•ä¿ç•™äº†å½¢çŠ¶ï¼Œå°±è¿‘ç®—æ³•ä¿ç•™äº†åƒç´ å·®å¼‚ ç»„é€æ˜Žç›¸å¯¹äºŽUIViewçš„alphaå±žæ€§ï¼ŒCALayerçš„å±žæ€§æ˜¯opacityï¼Œè¿™ä¸¤ä¸ªå±žæ€§ä¼šå½±å“å­å›¾å±‚ã€‚ ä½†æ˜¯å¦‚æžœè§†å›¾åŒ…å«å­è§†å›¾ï¼Œå­è§†å›¾çš„èƒŒæ™¯è‰²ä¼šå¯¹é€æ˜Žé€ æˆå›°æ‰°ã€‚è¿™æ—¶å€™å¯ä»¥é…ç½®ç»„é€æ˜Žã€‚ 1ã€é¦–å…ˆåœ¨plistæ–‡ä»¶ä¸­æ·»åŠ UIViewGroupOpacityå±žæ€§è®¾ç½®ä¸ºYESã€‚ 2ã€CALayerçš„å±žæ€§shouldRasterizeè®¾ç½®æˆYESã€‚ï¼ˆè®¾ç½®å‰ï¼Œå›¾å±‚å’Œå­å›¾å±‚ä¼šè¢«è§†ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä»Žè€Œä¸ä¼šæœ‰é€æ˜Žæ··åˆé—®é¢˜ï¼‰å¦‚æžœè®¾ç½®äº†è¯¥å±žæ€§ï¼Œå°±éœ€è¦è°ƒæ•´rasterizationScaleå±žæ€§åŒ¹é…å±å¹•ï¼ˆé»˜è®¤å€¼1.0ï¼‰ï¼Œå¦åˆ™åœ¨Retainå±å¹•ä¸Šå¯èƒ½å‡ºçŽ°åƒç´ åŒ–é—®é¢˜ã€‚ å˜æ¢åå°„å˜æ¢UIViewçš„transformå±žæ€§æ˜¯ä¸€ä¸ªCGAffineTransformç±»åž‹ï¼Œå¯ç”¨äºŽäºŒç»´ç©ºé—´åæ—‹è½¬ã€ç¼©æ”¾å’Œå¹³ç§»ç­‰ã€‚ CALayerä¹Ÿæœ‰transformå±žæ€§ä½†æ˜¯æŽ¥æ”¶çš„æ˜¯CATransform3Dã€‚å¯¹åº”äºŒç»´å˜æ¢çš„å±žæ€§æ˜¯affineTransform äºŒç»´å˜æ¢ä¸»è¦å‡½æ•°å¦‚ä¸‹ï¼š ç”ŸæˆCAffinetransformå¯¹è±¡ CGAffineTransformIdentity ä¸»è¦å˜æ¢ CGAffineTransformMakeRotation(CGFloat angle) CGAffineTransformMakeScale(CGFloat x,CGFloat y) CGAffineTransformMakeTranslation(CGFloat tx,CGFloat ty) ç»„åˆå˜æ¢ CGAffineTransformRotate(CGAffineTransform t,CGFloat angle) CGAffineTransformScale(CGAffineTransform t,CGFloat x,CGFloat y) CGAffineTransformTranslation(CGAffineTransform t,CGFloat x,CGFloat y) æ··åˆ CGAffineTransformConcat(CGAffineTransform t1,CGAffineTransform t2) å˜æ¢çš„é¡ºåºå½±å“å˜æ¢ç»“æžœ ##### 3Då˜æ¢ CATransform3Då’ŒCGAfineTransformä¸åŒï¼Œå‰è€…ç”±Core Animation æ¡†æž¶æä¾›çš„ï¼Œç›¸å¯¹äºŽåŽè€…æä¾›äº†zè½´æŽ¥å£ã€‚åŽè€…æ˜¯ç”±Core Graphicesæä¾›ä¸¥è°¨çš„2Dç»˜åˆ¶ã€‚ å¸¸ç”¨å‡½æ•°: &gt; CATransitionform3DMakeRotation(CGFloat angle,CGFloat x,CGFloat y,CGFloat z) &gt; &gt; CATransitionform3DMakeScale(CGFloat sx,CGFloat sy,CGFloat sz) &gt; &gt; CATranstionform3DMakeTranslation(CGFloat tx,CGFloat ty,CGFloat tz) è™½ç„¶å±žäºŽ3Då˜æ¢ï¼Œä½†æ˜¯è½¬æ¢ä¹‹åŽçœ‹èµ·æ¥å’Œ2Dè½¬æ¢æ²¡æœ‰åŒºåˆ«ï¼Œä¾ç„¶æ˜¯æ‰å¹³åŒ–çš„ã€‚åŽŸå› åœ¨äºŽå½“è§†å›¾è½¬æ¢ä¹‹åŽæˆ‘ä»¬å±å¹•å±•ç¤ºè§†å›¾çš„è§’åº¦éšä¹‹æ”¹å˜ï¼Œæ‰€ä»¥çœ‹èµ·æ¥å’Œ2Dè½¬æ¢æ²¡æœ‰åŒºåˆ«ã€‚ ##### é€è§†æŠ•å½± ä¸ºäº†å±•ç¤ºå‡º3Då˜æ¢æ•ˆæžœï¼Œéœ€è¦è°ƒæ•´3Då˜æ¢å‚æ•°ä¸­çš„æ”¹å˜æ‘„åƒæœºè·ç¦»ã€‚åœ¨CATransition3Dä¸­çš„zè½´å‚æ•°ï¼Œm34ï¼ˆé»˜è®¤å€¼0ï¼‰ã€‚åœ¨å®žé™…å–å€¼æ—¶ï¼ŒæŒ‰ç…§å¸¸è§„ä¹ æƒ¯m34 = - 1.0 / dã€‚dçš„èŒƒå›´åœ¨500 - 1000 å·¦å³ï¼Œè¿‡å¤§é€è§†ä¸æ˜Žæ˜¾ï¼Œè¿‡å°ä¼šæ˜¾å¾—å¤±çœŸã€‚ ##### ç­ç‚¹ é€è§†è§†è§’ç»˜å›¾æ—¶ï¼Œç¦»ç›¸æœºè§†è§’è¶Šè¿œç‰©ä½“è¶Šå°ï¼Œåˆ°è¾¾æžé™è·ç¦»åŽæ‰€æœ‰çš„è§†å›¾éƒ½ä¼šç¼©æˆä¸€ä¸ªç‚¹ã€‚ Core Animationå®šä¹‰è¿™ä¸ªç‚¹ä½äºŽå˜æ¢å›¾å±‚çš„anchorPointï¼ˆé”šç‚¹æ˜¯å¯ä¿®æ”¹çš„ï¼‰ã€‚ &gt; åœ¨åšè½¬æ¢å‰éœ€è¦è°¨è®°ï¼Œåº”ä¿è¯ç­ç‚¹å’Œå±å¹•çš„ç­ç‚¹ç›¸åŒï¼Œé€šè¿‡å‡½æ•°è¿›è¡Œå˜æ¢æ“ä½œï¼Œè€Œä¸æ˜¯æ”¹å˜å…¶positionå±žæ€§ã€‚ ##### sublayerTransformå±žæ€§ ä¸€ä¸ªTransiform3Dç±»åž‹å±žæ€§ï¼Œæ‰€æœ‰å­è§†å›¾éƒ½å°†ç»§æ‰¿è¯¥å±žæ€§ï¼Œå½“å˜åŒ–æ—¶ä¸éœ€è¦é€ä¸ªè®¾ç½®ã€‚ ##### èƒŒé¢ å½“å›¾å±‚è¢«æ—‹è½¬180åº¦åŽï¼ŒGPUè¿˜ä¼šç»˜åˆ¶èƒŒé¢å›¾ï¼ˆåå‘ç»˜åˆ¶ï¼‰ã€‚å¯ä»¥é€šè¿‡CALayerçš„doubleSidedå±žæ€§æŽ§åˆ¶æ˜¯å¦ç»˜åˆ¶èƒŒé¢ã€‚ ä¸“ç”¨å›¾å±‚CAShapeLayerCAShaoeLayeræ˜¯é€šè¿‡ä¸€ä¸ªçŸ¢é‡å›¾è€Œä¸æ˜¯bitmapç»˜åˆ¶ç»˜åˆ¶å›¾å±‚å­ç±»ã€‚å¯ä»¥æŒ‡å®šé¢œè‰²å’Œçº¿å®½ç­‰å±žæ€§ï¼Œä½¿ç”¨CGPathå®šä¹‰ç»˜åˆ¶è·¯å¾„ï¼Œæœ€åŽé€šè¿‡CAShapeLayerè‡ªå®šæ¸²æŸ“ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨Core Graphics è¿›è¡Œç»˜åˆ¶ï¼Œä½†ä½¿ç”¨CAShapeLayeræœ‰å¦‚ä¸‹æœ‰ç‚¹ æ¸²æŸ“é€Ÿåº¦å¿«ã€‚å¯ç”¨ç¡¬ä»¶åŠ é€Ÿã€‚ æ›´å°çš„å†…å­˜æ¶ˆè€—ã€‚ä¸éœ€è¦åˆ›å»ºå¯„å®¿å›¾ã€‚ ä¸ä¼šè¢«è¾¹ç¼˜è£æŽ‰ã€‚ ä¸ä¼šåƒç´ åŒ–ã€‚ æ€§èƒ½æ›´ä¼˜è¶Šçš„åœ†è§’æ–¹æ¡ˆï¼Œé€šè¿‡BezierPathæ›´å…·å½“å‰å¯„å®¿å›¾ç»˜åˆ¶åœ†è§’çŸ©å½¢ï¼ŒæŠŠè·¯å¾„èµ‹å€¼æ›´CAShapeLayerçš„pathå±žæ€§ï¼Œä¸åˆ›å»ºå¯„å®¿å›¾ï¼Œæ²¡æœ‰ä¼˜åŒ–é—®é¢˜ã€‚ðŸ˜ CATextLayerUILabelçš„æ ¸å¿ƒç»˜åˆ¶æ–¹æ³•ï¼Œ UILabelåœ¨iOS6ä¹‹å‰æ˜¯ä½¿ç”¨WebKitå®žçŽ°çš„ç»˜åˆ¶çš„ ã€‚ ä¼˜ç‚¹ï¼š ç»˜åˆ¶é€Ÿåº¦æ›´å¿« æ›´å¤šæ ·çš„ç»˜åˆ¶ç‰¹æ€§ ç»˜åˆ¶é—´è·å·®å¼‚ï¼Œç”±äºŽç»˜åˆ¶æœºåˆ¶ä¸åŒå¯¼è‡´çš„ç»˜åˆ¶é—´è·å’Œå­—ä½“å¯èƒ½æœ‰ç»†å¾®çš„å·®å¼‚ã€‚ æ³¨æ„äº‹é¡¹ï¼š ç”±äºŽcontentScaleå±žæ€§é»˜è®¤ä¸º1.0ï¼Œæ‰€ä»¥åœ¨Retainå±å¹•ä¸Šå¯èƒ½ä¼šå¤±çœŸï¼Œéœ€è¦è®¾ç½®ã€‚ å­—ä½“æ˜¯CTFontRefç±»åž‹ï¼Œéœ€è¦ä½¿ç”¨CGFontRefä½œä¸ºä¸­é—´å€¼è¿›è¡Œè½¬æ¢ã€‚ stringæŽ¥æ”¶NSStringæˆ–NSAttributedStringã€‚ æ›¿æ¢UILabelçš„ç»˜åˆ¶æ–¹æ¡ˆå®žçŽ°ä¸€ä¸ªUILabelçš„å­ç±»ï¼Œä¿®æ”¹å…¶å¯„å®¿å›¾ç±»åž‹ï¼ˆUIViewä¼šé€šè¿‡+layerClassæ–¹æ³•èŽ·å–å¯„å®¿å›¾ç±»åž‹ï¼‰ï¼Œåˆ©ç”¨UIViewå’ŒCALayerçš„å¹³è¡Œå±‚çº§å…³ç³»ï¼Œåªè¦é‡å†™éƒ¨åˆ†èµ‹å€¼ä»£ç ï¼Œå³å¯ã€‚ CATransformLayerä¸åŒäºŽå…¶ä»–çš„CALayerå­ç±»ï¼Œä»–ä¸ä¼šæ‰å¹³åŒ–å­å›¾å±‚ã€‚å³ä¸ä¼šå°†Z = 0ï¼Œå­å›¾å±‚å°†åŒ…æœ‰åŽŸæ¥çš„å±‚çº§å’Œç»˜åˆ¶3Då…³ç³»ã€‚ ç›¸å¯¹äºŽå…¶ä»–CALayerï¼Œä¸ä¼šè¢«å®žçŽ°çš„å±žæ€§æœ‰ï¼š backgroundColor,contents,border style,stroke styleç­‰å±žæ€§ 2Då›¾åƒä¸­ï¼šfilters,backgroundFilters,compositingFilter,mask,masksToBoundså’Œshadow styleç­‰å±žæ€§ ä¸ä¼šå®žçŽ°ç»„å¤´åç­–ç•¥å’Œå›¾å±‚ä¸é€æ˜Žç­–ç•¥ ä¸åº”è°ƒç”¨hitTest:æ–¹æ³•ï¼Œåº”ä¸ºå¯èƒ½è¯¥å›¾å±‚æ²¡æœ‰2Dåæ ‡å¯¹åº”ã€‚ CAGradientLayerç”¨äºŽç»˜åˆ¶ä¸€æˆ–å¤šç§æ¸å˜è‰²çš„å›¾å±‚ã€‚ä½¿ç”¨Core Graphics ç»˜åˆ¶ä¸€ä¸ªCAGradientLayerå®žçŽ°æ¸å˜è‰²ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯CAGradientLayerç»˜åˆ¶å¼€å¯äº†ç¡¬ä»¶åŠ é€Ÿæ‰€ä»¥æ›´ä¸ºå¿«é€Ÿã€‚ å¸¸ç”¨å±žæ€§ï¼š colors æŽ¥æ”¶æ¸è‰²å½©æ•°ç»„ï¼ˆæŽ¥æ”¶é¢œè‰²ä¸ºCGColorRefç±»åž‹ï¼‰ locations æŽ¥æ”¶NSNumberç±»åž‹æ•°ç»„ï¼Œç”¨äºŽä¿æŒé˜¶æ¢¯ç»˜åˆ¶æ—¶åœæ­¢ç»˜åˆ¶æ¢¯åº¦ã€‚ startPoint/endPoint èµ·/æ­¢ç‚¹ å•ä½åæ ‡ type ç»˜åˆ¶ç±»åž‹ CAReplicatorLayerç”¨äºŽç»˜åˆ¶æŒ‡å®šæ•°é‡å¹¶å¤åˆ¶å‡ ä½•å˜åŒ–ï¼Œé¢œè‰²å’Œæ—¶é—´å‚æ•°ç­‰å±žæ€§çš„Layerã€‚ å¸¸ç”¨å±žæ€§ï¼š instanceCount åˆ›å»ºæ•°é‡ instanceDelay æŒ‡å®šå»¶è¿Ÿ instanceTransform æŒ‡å®šå˜æ¢ preservesDepth æ˜¯å¦å‡å°‘å±žæ€§å’ŒCATransformLayerç±»ä¼¼ï¼Œé»˜è®¤æ˜¯NO InstanceColor é»˜è®¤é¢œè‰² instanceRedOffset/instanceGreenOffset/instanceBlueOffset/instanceAlphaOffset å¯¹åº”è¾ƒå°‘çš„é¢œè‰²æˆ–é€æ˜Žåº¦çš„å€¼ æç¤ºï¼š ç›®å‰hitTest:åªæµ‹è¯•äº†ç¬¬ä¸€ä¸ªLayerï¼Œä¹‹åŽå¯èƒ½ä¼šå®Œå–„ã€‚ï¼ˆä¹Ÿå°±æ˜¯å½“è°ƒç”¨è¿™ä¸ªæ–¹æ³•åœ¨å¤åˆ¶çš„å›¾å±‚æ˜¯å¯èƒ½è¿”å›žä¸æ­£ç¡®ï¼‰ðŸ˜… CAEmitterLayerç”¨äºŽç»˜åˆ¶ç²’å­æ•ˆæžœçš„å›¾å±‚ CAEmitterCellç»˜åˆ¶ç²’å­æ•ˆæžœæ—¶çš„å­å›¾å±‚ å¸¸ç”¨å±žæ€§æœ‰: +emitterCell æž„é€ æ–¹æ³• enabled æ˜¯å¦æ˜¾ç¤º emitterCells å¯é€‰å±žæ€§åŒ…å«emittercellçš„å­ç±» color æ¯ä¸ªç²’å­çš„é¢œè‰² redRange/redSpeech/blueRange/blueSpeech/greenRange/greenSpeech/alphaRange/alphaSpeech é¢œè‰²å’Œé€æ˜Žåº¦çš„å˜åŒ–èŒƒå›´å’Œé€Ÿåº¦ magnificationFilter æ–¹æ³•æ»¤æ³¢ minificationFilter ç¼©å°æ»¤æ³¢ minificationFilterBias ç¼©å°è¿‡æ»¤åå¥½ scale /scaleRange æ˜¾ç¤ºæ¯”ä¾‹å’Œæ¯”ä¾‹èŒƒå›´ name cellçš„åå­— style é»˜è®¤ä¸ºnilï¼Œä¸€ä¸ªé”®å€¼å¯¹å½¢å¼çš„å­—å…¸ï¼Œé€šè¿‡é”®èµ‹å€¼ã€‚ä¹Ÿå¯é€šè¿‡æš´éœ²çš„æ–¹æ³•defaultValueForKey:è¿›è¡Œè®¾ç½®ï¼ˆå¦‚æžœè¯¥å€¼ä¸èƒ½è¢«ä¿å­˜åœ¨å­—å…¸å†…æ—¶ï¼‰ spin/spinRange æ—‹è½¬é€Ÿåº¦å’Œæ—‹è½¬é€Ÿåº¦èŒƒå›´ emissionLatitude/emissionLongitude/emissionRange æ¨ªå‘/çºµå‘å‘å°„è§’åº¦å’Œé”¥å½¢å‘å°„è§’åº¦ lifetime/lifetimeRange ç”Ÿå­˜æ—¶é—´å’Œç”Ÿå­˜æ—¶é—´èŒƒå›´ birthRate æ¯ç§’ç”Ÿæˆæ•°é‡ scaleSpeech æ¯”ä¾‹æ”¹å˜é€Ÿåº¦ velocity/velocityRange åˆå§‹é€Ÿåº¦å’Œé€Ÿåº¦èŒƒå›´ xAcceleration/yAcceleration/zAcceleration x/y/zè½´åŠ é€Ÿåº¦ -shouldArchiveValueForKey: æ£€æŸ¥æ—¶å€™åŒ…å«è¿™ä¸ªé”® +defaultValueForKey: è®¾ç½®é”®å€¼ å¸¸ç”¨å±žæ€§æœ‰ï¼š emitterCells åŒ…å«çš„cellç±»åž‹ renderMode å®šä¹‰äº†é¢—ç²’ç»†èƒžå‘ˆçŽ°å±‚ emitterPosition æ•ˆæžœä½ç½®ç‚¹ emitterShape æ•ˆæžœå½¢çŠ¶ emitterZPosition zè½´å½¢çŠ¶ emitterDept æ·±åº¦ emitterSize å¤§å° Emitter Shape å®šä¹‰äº†ä¸‰ä¸ªæ–¹å‘ä¸Šçš„å¤§å° ç›¸å…³å±žæ€§emitterPostion/emitterzPosition/emitterDept/emitterSize Emitter Mode å®šä¹‰äº†å‘å°„æ¨¡å¼ ç›¸å…³å±žæ€§emitterMode Emitter Render Order å‘å°„é¡ºåº å¯¹åº”å±žæ€§renderMode CAScrollLayer ç±»ä¼¼äºŽScrollViewçš„å›¾å±‚ï¼Œå¯ç”¨äºŽæ˜¾ç¤ºå®žé™…å¤§å°å¤§äºŽè‡ªèº«çš„è§†å›¾ã€‚ ç³»ç»Ÿæä¾›äº†: -scrollPoint:(CGPoint) -scrollRectToVisible:(CGRect) visibleRect å¯è§†èŒƒå›´ scrollMode NSStringç±»åž‹ç”¨äºŽæ˜¾ç¤ºå½“å‰æ»šåŠ¨çŠ¶æ€ CATiledLayer åŒºåŸŸåŒ–åŠ è½½å›¾å±‚ï¼Œè‡ªå¸¦æ·¡å…¥æ·¡å‡ºæ•ˆæžœã€‚ç”¨äºŽè§£å†³è¿‡å¤§è§†å›¾å¯¼è‡´çš„åŠ è½½æ€§èƒ½é—®é¢˜ã€‚ å¸¸ç”¨æ–¹æ³• +fadeDuration æ·¡å…¥æ•ˆæžœåŠ è½½æ—¶é—´ï¼Œå•ä½ç§’ã€‚ titleSize æ¯ä¸ªå•å…ƒçš„ç»˜åˆ¶å¤§å°ï¼Œé»˜è®¤{256ï¼Œ256} levelsofDetail ç­‰çº§åŒºåˆ†ï¼Œæ¯ä¸ªç­‰çº§çš„çš„è¯¦ç»†ç¨‹åº¦æ˜¯å‰è€…çš„ä¸€åŠï¼Œå¦‚æžœæœ‰å¤šä¸ªæ•°è‡ªè¿”å›žï¼Œé»˜è®¤è¿”å›žæœ€å¤§å€¼ã€‚æœ€å¤§çº§åˆ«å±å¹•å°†åªæ˜¾ç¤ºä¸€ä¸ªåƒç´ ç‚¹ã€‚ levelOfDetailBias å¯æ”¾å¤§å€æ•°ï¼Œé»˜è®¤ä¸º0ã€‚ï¼ˆå¦‚æžœä¸º2åˆ™å¯æ”¾å¤§è‡³2xå’Œ4xï¼‰â€‹ åŠ¨ç”»éšå¼åŠ¨ç”»å½“ä¿®æ”¹CALayerå¯åŠ¨ç”»å±žæ€§æ˜¯é»˜è®¤ç”±CATransationé»˜è®¤æ‰§è¡Œäº†0.25ç§’çš„åŠ¨ç”»ï¼ŒCATransationæ²¡æœ‰åˆ›å»ºæ–¹æ³•ï¼Œä»…æä¾›+commitå’Œ+beginæ–¹æ³•ã€‚ï¼ˆè€ŒUIViewçš„beginAnimationï¼š/commitAnimationè¿˜æœ‰blockåŠ¨ç”»ç­‰æ–¹æ³•éƒ½æ˜¯å¯¹CATransationçš„å°è£…ã€‚ï¼‰ éšå¼åŠ¨ç”»æ‰§è¡Œæ­¥éª¤ï¼š å›¾å±‚æ£€æµ‹æ˜¯å¦åŒ…å«ä»£ç†ï¼Œå¸¦ä½ æ˜¯å¦å®žçŽ°-actionForLayer:forKeyï¼Œæœ‰å°±è°ƒç”¨ä»£ç†æ–¹æ³•ã€‚ å¦‚æžœæ²¡æœ‰ï¼Œåˆ™æ£€æŸ¥åŒ…å«å±žæ€§åç§°çš„Actionå­—å…¸ã€‚ å¦‚æžœä»æ²¡æœ‰ï¼Œåˆ™è°ƒç”¨styleå­—å…¸æœç´¢å±žæ€§åã€‚ è¿˜æ˜¯æ²¡æœ‰çš„è¯ï¼Œè°ƒç”¨defaultActionForKey:æ–¹æ³•ã€‚ è¿˜å¯ä»¥CATransationæäº¤ä¹‹å‰è®¾ç½®setDisableAnimation:æ–¹æ³•ï¼Œä¹Ÿå¯å…³é—­æ‰€æœ‰éšå¼åŠ¨ç”»ã€‚ å› ä¸ºUIViewé»˜è®¤ä¸ºCALayerçš„ä»£ç†ï¼Œå½“ä¸åœ¨åŠ¨ç”»æäº¤å—å†…æ—¶ï¼Œå¯¹åº”çš„actionForLayer:forKeyæ–¹æ³•è¿”å›žnilï¼Œæœ‰åŠ¨ç”»blockæ—¶è¿”å›žå¯¹åº”çš„å€¼ã€‚ å¼€å¯éšå¼åŠ¨ç”» ç»§æ‰¿UIViewå®žçŽ°å¯¹åº”çš„ä»£ç†æ–¹æ³• è®¾ç½®CALayerçš„ä»£ç†ï¼Œè‡ªå·±å®žçŽ°è¯¥æ–¹æ³• è®¾ç½®actionå­—å…¸ï¼Œä¾›è°ƒç”¨æ—¶èŽ·å– å‘ˆçŽ°ä¸Žæ¨¡åž‹CALayerçš„é»˜è®¤è®¾ç½®å¾ˆä¸æ­£å¸¸ï¼Œæ”¹å˜ä¸€ä¸ªå€¼ä¸ºä»€ä¹ˆä¼šæœ‰ä¸€ä¸ªè¿‡ç¨‹ã€‚æ˜¯å› ä¸ºCoreAnimationæ‰®æ¼”äº†ä¸€ä¸ªæŽ§åˆ¶å™¨çš„è§’è‰²ï¼Œæ ¹æ®å›¾å±‚è¡Œä¸ºå’Œäº‹åŠ¡è®¾ç½®åˆ·æ–°å±å¹•çš„æ˜¾ç¤ºçŠ¶æ€ã€‚è¿™æ˜¯ä¸€ä¸ªå…¸åž‹çš„MVCæ¨¡åž‹ï¼ŒCALayerè´Ÿè´£æ˜¾ç¤ºå’Œå­˜å‚¨è§†å›¾æ¨¡åž‹ã€‚ å› ä¸ºå±å¹•æ¯ç§’åˆ·æ–°60æ¬¡ï¼Œåªè¦åŠ¨ç”»æ—¶é—´æ¯”60åˆ†1ç§’é•¿ï¼ŒCoreAnimationéœ€è¦ç»˜åˆ¶ä¸­é—´å€¼ï¼Œæ„å‘³ç€CALayeréœ€è¦å­˜å‚¨ä¸­é—´å€¼ï¼Œæ¯ä¸ªå›¾å±‚çš„æ˜¾ç¤ºå€¼éƒ½ä¼šè¢«å­˜æ”¾åœ¨ä¸€ä¸ªå«å‘ˆçŽ°å›¾å±‚çš„ç‹¬ç«‹å›¾å±‚ä¸­ï¼Œå¯ä»¥é€šè¿‡-presentationLayerè¿›è¡Œè®¿é—®ï¼Œè¿™ä¸ªå‘ˆçŽ°å±‚å®žé™…ä¸Šæ˜¯æ¨¡åž‹å›¾å±‚çš„å¤åˆ¶ï¼Œä½†å®ƒçš„å±žæ€§å€¼ä»£è¡¨äº†ä»»æ„æ—¶åˆ»ä¸‹å½“å‰å›¾å±‚çš„å¤–è§‚æ•ˆæžœï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥å›¾å±‚æ˜¯å½“å‰å›¾å±‚çš„æ˜¾ç¤ºå‡ºæ¥çš„å€¼ã€‚ å‘ˆçŽ°æ ‘ç”±å½“å‰å›¾å±‚ä¸­æ‰€æœ‰çš„å‘ˆçŽ°å›¾å±‚æ‰€å½¢æˆã€‚å‘ˆçŽ°å›¾å±‚ä»…ä»…å½“é¦–æ¬¡è¢«æäº¤æ˜¯æ‰å­˜åœ¨ï¼Œä¹‹å‰è°ƒç”¨æ—¶ä¸å­˜åœ¨çš„ã€‚-modelLayerè¿”å›žå‘ˆçŽ°æ‰€ä¾èµ–çš„Layeré€šå¸¸æ˜¯selfã€‚ åˆ©ç”¨å‘ˆçŽ°å›¾å±‚ï¼š éœ€è¦å®žçŽ°ç±»ä¼¼å®šæ—¶å™¨çš„åŠ¨ç”»æ—¶ï¼Œéœ€è¦çŸ¥é“æ¯æ—¶é—´ç‚¹å›¾å±‚çš„å…·ä½“ä½ç½®ã€‚ å½“éœ€è¦åœ¨å˜æ¢è¿‡ç¨‹ä¸­è¿›è¡Œäº¤äº’æ—¶ï¼Œç”±presnetationLayeræ¥å¤„ç†äº¤äº’ï¼Œå±•ç¤ºæ›´ä¸ºåˆç†ã€‚ å–æ¶ˆåŠ¨ç”»CALayerçš„æ–¹æ³•å¯ä»¥èŽ·å–å’Œç§»é™¤å¯¹åº”çš„åŠ¨ç”» -(CAAnimation*)animationForKey: -removeAnimationForKey: -removeAllAnimations å½“åŠ¨ç”»è¢«ç§»é™¤ï¼Œå›¾å±‚çš„å¤–è§‚å°†ç«‹åˆ»æ›´æ–°åˆ°å½“å‰æ¨¡åž‹å›¾å±‚çš„å€¼ã€‚é™¤éžåœ¨è®¾ç½®åŠ¨ç”»å¯¹è±¡çš„å±žæ€§removedOnCompletionä¸ºNOï¼Œå¦åˆ™åŠ¨ç”»å°†ä¸€ç›´ä¿å­˜ï¼ŒçŸ¥é“å›¾å±‚è¢«é”€æ¯ã€‚ å›¾å±‚æ—¶é—´CAMediaTimingåè®®ï¼Œå®šä¹‰äº†ä¸€æ®µåŠ¨ç”»å†…ç”¨æ¥æŽ§åˆ¶é€åŽ»æ—¶é—´çš„å±žæ€§çš„é›†åˆã€‚CALayerã€CAAnimationå’ŒCAEmitterCelléƒ½å®žçŽ°äº†è¯¥åè®®ï¼Œæ‰€ä»¥æ—¶é—´å¯ä»¥è¢«ä»»æ„åŸºäºŽåŸºäºŽä¸€ä¸ªå›¾å±‚æˆ–è¿™ä¸€æ®µåŠ¨ç”»çš„ç±»æŽ§åˆ¶ã€‚ æŒç»­å’Œé‡å¤åè®®ä¸­durationå’ŒrepeatCountå±žæ€§åˆ†åˆ«æ˜¯å•è¯æŒç»­æ—¶é—´å’Œé‡å¤æ¬¡æ•°ï¼Œå‡è®¾ä¸€ä¸ªåŠ¨ç”»çš„durationä¸º2ï¼ŒrepeatCountä½2.5æ¬¡é‚£ä¹ˆåŠ¨ç”»çš„æ’­æ”¾æ—¶é—´å°±æ˜¯5ç§’ã€‚ å‡è®¾durationå’ŒrepeatCountéƒ½ä¸º0ï¼Œä¸è¡¨ç¤ºä¸æ‰§è¡ŒåŠ¨ç”»ã€‚ä»…ä»£è¡¨é»˜è®¤å€¼ï¼Œ0.25ç§’å’Œ1æ¬¡ã€‚è¿˜æœ‰2ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„æŽ§åˆ¶å±žæ€§ï¼ŒrepeatDurationå’Œautoreverses,repeatDurationå’ŒrepeatCountç›¸ä¼¼å½“è®¾ç½®ä¸ºINFINITYæ—¶éƒ½å°†æ— é™é‡å¤ä¸‹åŽ»ï¼Œè€Œautoreversesåˆ™è¡¨ç¤ºæ–¹å‘åŠ¨ç”»ï¼Œå³æ–¹å‘é‡å¤åŠ¨ç”»æ•ˆæžœï¼Œå› æ­¤ï¼Œå¯ä»¥è®¾ç½®ä¸€äº›è¿žç»­çš„éžé‡å¤åŠ¨ç”»ã€‚ ç›¸å¯¹æ—¶é—´Core Animationä¸­å®šä¹‰äº†æ—¶é—´ï¼Œæ‰€æœ‰çš„æ—¶é—´éƒ½æ˜¯ç›¸å¯¹çš„ã€‚æ¯ä¸ªåŠ¨ç”»éƒ½æœ‰è‡ªå·±çš„æè¿°æ—¶é—´ï¼Œå¯ä»¥å•ç‹¬åŠ é€Ÿæˆ–è€…è®¾ç½®åç§»ã€‚ beginTime åŠ¨ç”»å¼€å§‹çš„å»¶è¿Ÿï¼Œé»˜è®¤0.å³åŠ è½½åˆ°è§†å›¾ä¸Šç«‹åˆ»å¼€å§‹åŠ¨ç”» timeOffset å¿«è¿›åˆ°æŸä¸€ä½ç½® speed åŠ¨ç”»æ’­æ”¾é€Ÿåº¦ fillModeå¯¹äºŽbeginTimeéž0çš„åŠ¨ç”»ä¼šå‡ºçŽ°ï¼ŒåŠ è½½åˆ°å›¾å±‚ä¸Šä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿçš„çŠ¶æ€ï¼Œåœ¨autoreversesæ˜¯é»˜è®¤å€¼NOçš„å›¾å±‚ä¸Šåœ¨åŠ¨ç”»ç»“æŸæ—¶ä¿æŒä¹‹å‰çš„çŠ¶æ€ã€‚åœ¨åŠ¨ç”»å¼€å§‹ä¹‹å‰å’Œç»“æŸä¹‹åŽï¼Œè¢«è®¾ç½®çš„åŠ¨ç”»å±žæ€§å°†ä¼šæ˜¯ä»€ä¹ˆã€‚ ä¸€ç§å¯èƒ½å±žæ€§å’ŒåŠ¨ç”»æ²¡è¢«æ·»åŠ ä¹‹å‰ä¿æŒä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯æ¨¡åž‹å›¾å±‚å®šä¹‰çš„å€¼ã€‚ å¦ä¸€ç§å¯èƒ½ä¿æŒåŠ¨ç”»å¼€å§‹çš„é‚£ä¸€å¸§å’Œç»“æŸçš„é‚£ä¸€å¸§ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å¡«å……ï¼Œç”¨åŠ¨ç”»å¼€å§‹çš„å€¼å’Œç»“æŸçš„å€¼ï¼Œå¡«å……åŠ¨ç”»å¼€å§‹ä¹‹å‰å’Œç»“æŸä¹‹åŽçš„æ—¶é—´ã€‚ fillModeå±žæ€§å¦‚ä¸‹ kCAFillModeForwards kCAFillModeBackwards kCAFillModeBoth kCAFillModeRemoved ï¼ˆé»˜è®¤å€¼ï¼‰ æ³¨æ„äº‹é¡¹ï¼š éœ€è¦å°†animationå¯¹è±¡è®¾ç½®ä¸ºé”®å€¼éžç©ºï¼Œå¯ä»¥åœ¨åŠ¨ç”»å®ŒæˆåŽæ‰‹åŠ¨ç§»é™¤ã€‚ ä¿®æ”¹removedOnCompletionä¸ºNOï¼ˆé»˜è®¤ä¸ºYESï¼‰ æ‰‹åŠ¨åŠ¨ç”»é€šè¿‡ä¿®æ”¹timeOffsetæ¥æŽ§åˆ¶åŠ¨ç”»çš„è¿›åº¦ï¼Œå½“speedä¸º0æ˜¯ï¼ŒåŠ¨ç”»ä¸è‡ªåŠ¨æ’­æ”¾ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®timeOffsetçš„å€¼æ¥è¾¾åˆ°æ‰§è¡ŒåŠ¨ç”»çš„ç›®çš„ã€‚åœ¨ä½¿ç”¨å¤æ‚åŠ¨ç”»ç»„çš„æ—¶å€™å°¤ä¸ºæ˜Žæ˜¾ã€‚ ç¼“å†²Core Animation ä½¿ç”¨ç¼“å†²ä½¿åŠ¨ç”»æ›´ä¸ºå¹³ç¼“å’Œè‡ªç„¶ã€‚ åŠ¨ç”»é€Ÿåº¦åŠ¨ç”»å®žé™…å°±æ˜¯ä¸€æ®µæ—¶é—´å†…çš„å˜æ¢ï¼Œä¹Ÿæš—ç¤ºç€åŠ¨ç”»ä¼šéšç€æŸä¸€ç‰¹å®šçš„é€ŸçŽ‡è¿›è¡Œã€‚ é€Ÿåº¦é€ŸçŽ‡è®¡ç®—å¦‚ä¸‹ 1velocity = change / time è¿™é‡Œçš„é€Ÿåº¦å¯ä»¥æ—¶ç§»åŠ¨çš„è·ç¦»ï¼Œä¹Ÿå¯ä»¥æ˜¯èƒŒæ™¯é¢œè‰²ç­‰å¯è®¾ç½®åŠ¨ç”»æ•ˆæžœçš„å±žæ€§ã€‚ ä¸ºäº†è¾¾åˆ°æ›´ä¸ºçœŸæ˜¯çš„åŠ¨ç”»æ•ˆæžœï¼Œå³éžçº¿æ€§åŠ¨ç”»æ•ˆæžœã€‚Core Animation æä¾›äº†CAMediaTimingFunctionç±»å¯¹è±¡ï¼Œé€šè¿‡ä¿®æ”¹CAAnimationçš„timingFunctionå±žæ€§æˆ–é€šè¿‡CATransationçš„ +setAnimationTimingFunction:æ–¹æ³•ã€‚ é€šå¸¸è°ƒç”¨+timingFunctionWithName:ä¼ å…¥å¯¹åº”å­—æ®µï¼Œåˆ›å»ºCAMediaTimingFunctionå¯¹è±¡ï¼Œå¸¸ç”¨å­—æ®µå¦‚ä¸‹ kCAMediaTimingFunctionLinear çº¿æ€§å‡½æ•° kCAMediaTimingFunctionEaseIn ç¼“æ…¢å¼€å§‹çº¿æ€§ç»“æŸ kCAMediaTimingFunctionEaseOut çº¿æ€§å¼€å§‹ç¼“æ…¢ç»“æŸ kCAMediaTimingFunctionEaseInEaseOut ç¼“æ…¢ç»“æŸç¼“æ…¢å¼€å§‹ kCAMediaTimingFunctionDefault ç›¸å¯¹äºŽä¸Šé¢çš„é€‰é¡¹å¼€å§‹é€Ÿåº¦å¿«å’Œç»“æŸçš„é€Ÿåº¦æ›´ä¸ºç¼“æ…¢ï¼Œå› æ­¤ä¹Ÿæ›´ä¸ºçœŸå®žï¼ˆUIViewåŠ¨ç”»é»˜è®¤å‡½æ•°ï¼‰ UIViewçš„åŠ¨ç”»ç¼“å†²UIKitåŠ¨ç”»ä¹Ÿæœ‰ç¼“å†²å‡½æ•°ï¼Œoptioné€‰é¡¹å¦‚ä¸‹ï¼š UIViewAnimationOptionCurveEaseInOut ï¼ˆé»˜è®¤å€¼ï¼‰ UIViewAnimationOptionCurveEaseIn UIViewAnimationOptionCurveEaseOut UIViewAnimationOptionLinear ç¼“å†²å’Œå…³é”®å¸§åŠ¨ç”»CAKeyframeAnimationæœ‰ä¸€ä¸ªNSArrayç±»åž‹çš„å±žæ€§timeFunctionsã€‚å½“è®¾ç½®æ—¶ï¼Œå…¶æ•°é‡ä¸€å®šè¦æ˜¯keyframesæ•°ç»„çš„å…ƒç´ å‡ä¸€ä¸ªï¼Œå› ä¸ºè¯¥å‡½æ•°å¼æè¿°2ä¸ªå±žæ€§åŠ¨ç”»é€Ÿåº¦çš„å‡½æ•°ã€‚ è‡ªå®šä¹‰ç¼“å†²å‡½æ•°é™¤äº†functionWithName:å¤–ï¼ŒCAMediaTimingFunctionè¿˜æä¾›ç»™äº†+functionWithControlPoints::::å’Œ-initWithControlPoint::::å‡½æ•°ï¼Œç”¨äºŽæä¾›è‡ªå®šä¹‰ç¼“å†²å‡½æ•°ï¼Œä½¿ç”¨ä¸‰æ¬¡è´å¡žå°”æ›²çº¿å°†è¾“å…¥çš„æ—¶é—´è½¬åŒ–ä¸ºèµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´çš„æˆæ¯”ä¾‹æ”¹å˜ã€‚ å¯ä»¥é€šè¿‡CAMediaTimingFunctionæä¾›çš„-getControlPointAtPoint:Values:æ–¹æ³•ï¼ˆpointå‚æ•°å¿…é¡»ä»‹äºŽ0 ~ 3ä¹‹é—´ï¼‰ï¼ŒèŽ·å–çš„Valueæ˜¯ä¸ªfloat[]æ•°ç»„ï¼Œä¼ å…¥å¯¹åº”æŒ‡é’ˆå¯ä»¥èŽ·å–è¿™ä¸ªç‚¹çš„å€¼ã€‚ å› ä¸ºæœ¬èº«æ˜¯èŒƒå›´åæ ‡ï¼Œå¼€å§‹ç‚¹{0,0}ç»“æŸç‚¹{1,1}ã€‚å¯ä»¥é€šè¿‡UIBezierPathå’ŒCAShapeLayerç»˜åˆ¶å‡ºæ¥ï¼Œè¿™ä¹Ÿè®¸å°±æ˜¯ä¸ºä»€ä¹ˆè¿”å›žå€¼æ˜¯floatæ•°ç»„çš„åŽŸå› ï¼ˆå¿…å°†æ–¹ä¾¿å–å€¼â€¦ï¼‰ã€‚ æ›´ä¸ºå¤æ‚çš„ç¼“å†²åŠ¨ç”»å½“æ—¶éœ€è¦å®žçŽ°ç±»ä¼¼çƒä½“è½åœ°ç¼“å†²æ•ˆæžœæ—¶ï¼Œå•çº¯ä¾é ä¸‰æ¬¡è´å¡žå°”æ›²çº¿å¯èƒ½æ— æ³•å®Œæˆï¼Œä¸€æ¬¡å¯ä»¥å€ŸåŠ©CAKeyframeAnimationè®¾ç½®å¤šæ¬¡åŠ¨ç”»è¿‡åº¦å‡½æ•°å’Œå¯¹åº”çš„å€¼ï¼Œè¿›è¡Œä»¿çœŸå‡½æ•°å±•ç¤ºã€‚ è‡ªåŠ¨åŒ–æµç¨‹å¦‚æžœå°†å¤æ‚å‡½æ•°ä¸­çš„åˆ’åˆ†ä¸ºæ›´ä¸ºç»†å°çš„æ­¥éª¤ï¼Œåˆ©ç”¨å…³é”®å¸§åŠ¨ç”»å°±å¯ä»¥å®žçŽ°åŠ¨ç”»çš„è‡ªå®šä¹‰å˜æ¢ï¼ˆä¸ç”¨åŽ»è‡ªå·±ç»˜åˆ¶è´å¡žå°”æ›²çº¿ï¼‰ã€‚ 1value = (endvalue - startvalue) * time + startvalue ä»£ç ç¤ºä¾‹ï¼š 123456789101112131415161718192021222324252627282930float interpolate(float from,float to,float time)&#123; return (to - from) * time + from;&#125;- (id)interpolateFromeValue:(id)fromeValue ToValue:(id)toValue Time:(float)time&#123; const char *type = [fromValue objCType]; if (strcmp(type,@encode(CGPoint))== 0)&#123; CGPoint from = [fromeValue CGPointValue]; CGPoint to = [toValue CGPointValue]; CGPoint result = CGPointMake(interpolate(from.x,to.x,time),interpolate(from.y,to.y,time)); return [NSValue valueWithPoint:result]; &#125; return time &lt; 0.5?formValue:toVlaue;&#125;- animation&#123; self.ballView.center = CGPointMake(150,32); NSValue *fromeValue = [NSValue valueWithPoint:CGPointMake(150,32)]; NSValue *toValue = [NSValue valueWithPoint:CGPointMake(150,268)]; CFTimeInterval duration = 1; NSInteger numberCount = duration * 60;//æ¯ç§’60å¸§ NSMutableArray * frame = [NSMutableArray arrayWithCapacity:numberCount]; for(int i = 0 ,i &lt; numberCount,i ++)&#123; float time = i / (float)numberCount; [frame addObject:[self interpolateFromeValue:fromValue ToValue:toValue Time:time]]; &#125; CAKeyframeAnimation *animation = [CAKeyframeAniamtion animation]; animation.keyPath = @&quot;position&quot;; animation.duration = 1.0; animation.values = frame; [self.ballView.layer addAniamtion:animation forKey:nil];&#125; å› ä¸ºå‡½æ•°å¯èƒ½å±•ç¤ºç»“æžœä¸æ˜¯å¾ˆå‹å¥½ï¼Œå¦‚æžœéœ€è¦å®Œæˆéžå¸¸å¤æ‚çš„ç¼“å†²ã€‚éœ€è¦å€ŸåŠ©æ•°å­¦åŠŸåº•ï¼Œè¿˜å¥½æˆ‘ä»¬æœ‰ç½—ä¼¯ç‰¹ å½­çº³ã€‚åŒ…å«äº†å¤§å¤šæ•°ç¼“å†²åŠ¨ç”»å‡½æ•°ï¼Œä¸‹é¢å±•ç¤ºæ˜¯ä¸€ä¸ªç¼“å†²è¿›å…¥ç¼“å†²é€€å‡ºçš„å‡½æ•° 123float quardraticEaseInOut(float t)&#123; return t &lt; 0.5 ? (2 * t * t) :(-2 * t * t) + (4 * t) - 1;&#125; å¯¹äºŽSpringåŠ¨ç”» 1234567891011float boundsEaseOut(float t)&#123; if(t &lt; 4/11.0)&#123; return (121 * t * t) / 16.0; &#125;else if(t &lt; 8/11.0)&#123; return (365 / 40.0 * t * t) - (99 /10.0 * t) + 17/5.0; &#125;else if (t &lt; 9/11.0)&#123; return (4365 /361.0 * t * t) - (35442 / 1805.0 *t) + 16061/1805.0; &#125;else&#123; return (54/5.0 * t * t) - (513 / 25.0 * t) + 268 /25.0; &#125;&#125; æ›¿æ¢å®žçŽ°å‡½æ•°ï¼Œå³å¯ä¿®æ”¹åŠ¨ç”»æ•ˆæžœã€‚ åŸºäºŽå®šæ—¶å™¨çš„åŠ¨ç”»å®šæ—¶å¸§iOSæŒ‰ç…§æ¯ç§’60æ¬¡åˆ·æ–°å±å¹•ï¼Œç„¶åŽCAAnimationéœ€è¦æ¯æ¬¡éƒ½è®¡ç®—æ–°çš„å¸§å¹¶è®¡ç®—å·®å€¼ä¸Žç¼“å­˜ã€‚éœ€è¦ä¸€ä¸ªå®šæ—¶å™¨ï¼Œä»¥ä¾¿æŒ‰ç…§å±å¹•åˆ·æ–°æ¬¡æ•°è®¡ç®—éœ€è¦ç»˜åˆ¶éœ€è¦ç»˜åˆ¶çš„å€¼ã€‚å½“é€‰å–å®šæ—¶å™¨æ—¶CADisplayLinkæ¯”NSTimeæ›´ä¸ºåˆé€‚ï¼Œæœ‰ç‚¹å¦‚ä¸‹ï¼š åœ¨æœ‰å»¶è¿Ÿæ—¶ï¼Œé»˜è®¤å¿½ç•¥å»¶è¿Ÿå¸§ã€‚ å®šæ—¶å™¨ä¼šæ ¹æ®å±å¹•åˆ·æ–°é¢‘çŽ‡è®¡ç®—ã€‚ æ€§èƒ½ä¼˜åŒ–CPU VS GPUç»˜å›¾å’ŒåŠ¨ç”»æœ‰2ä¸­å¤„ç†æ–¹å¼ï¼šé€šè¿‡CPUæˆ–GPUã€‚CPUæ‰€æœ‰çš„å·¥ä½œéƒ½åœ¨è½¯ä»¶å±‚é¢ä¸Šï¼Œè€ŒGPUåœ¨ç¡¬ä»¶å±‚é¢ä¸Šã€‚ é€šå¸¸CPUå¯ä»¥å¤„ç†æ‰€æœ‰äº‹æƒ…ï¼Œä½†æ˜¯å¯¹äºŽå›¾åƒå¤„ç†ä½¿ç”¨ç¡¬ä»¶çš„è¯ä¼šæ›´å¿«ï¼Œå› ä¸ºGPUç»˜åˆ¶å›¾åƒæ—¶å¯¹é«˜åº¦æµ®ç‚¹è¿ç®—è¿›è¡Œäº†ä¼˜åŒ–ã€‚ä½†æ˜¯å› ä¸ºGPUæ²¡æœ‰æ— é™åˆ¶å¤„ç†æ€§èƒ½ï¼Œå½“èµ„æºæ¶ˆè€—åŠ å‰§åŽï¼Œæ€§èƒ½å°±ä¼šå¼€å§‹ä¸‹é™ã€‚ è¦å¤„ç†å¥½åŠ¨ç”»æ€§èƒ½ä¼˜åŒ–ï¼Œåº”å…ˆäº†è§£Core Animation å¦‚ä½•åœ¨2ä¸ªå¤„ç†å™¨é—´å·¥ä½œã€‚ åŠ¨ç”»çš„èˆžå°Core Animation åœ¨iOSä¸­æ˜¯æ ¸å¿ƒåº“ä¹‹ä¸€ï¼Œåº”ç”¨å†…å’Œåº”ç”¨é—´å¤šä¼šç”¨åˆ°ã€‚ä¸€ä¸ªå•ç‹¬çš„åŠ¨ç”»å¯èƒ½ä¼šæ¶‰åŠå¤šä¸ªAPPçš„å†…å®¹ï¼Œå¦‚ç¨‹åºåˆ‡æ¢ï¼Œåˆ†å±æ˜¾ç¤ºç­‰(iOS ä¸­ä¸èƒ½å®žçŽ°ï¼Œå› ä¸ºAPPéƒ½æœ‰ç‹¬ç«‹çš„æ²™ç›’)ã€‚ åŠ¨ç”»å’Œå±å¹•ç»„åˆçš„å›¾å±‚ï¼Œè¢«ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹æŽ§åˆ¶è€Œéžå½“å‰çš„APPï¼Œè¿™å°±æ˜¯æ¸²æŸ“æœåŠ¡ã€‚iOS5ä¹‹å‰æ˜¯SpringBoardï¼ŒiOS6ä¹‹åŽæ˜¯BackBoardã€‚ å½“è¿è¡Œä¸€ä¸ªåŠ¨ç”»æ—¶ï¼Œè¯¥åŠ¨ç”»ä¼šè¢«åˆ†ç¦»æˆç‹¬ç«‹çš„å››éƒ¨åˆ†ã€‚ å¸ƒå±€ â€” å‡†å¤‡è§†å›¾/å›¾å±‚çš„å±‚çº§å…³ç³»å’Œå›¾å±‚å±žæ€§çš„ç­‰ã€‚ æ˜¾ç¤º â€” å›¾å±‚å›¾ç‰‡è¢«ç»˜åˆ¶ï¼Œå¯èƒ½æ¶‰åŠdrawRect:å’ŒdrawLayer:inCentext:ç­‰ å‡†å¤‡ â€” å‡†å¤‡å‘é€åŠ¨ç”»æ•°æ®åˆ°æ¸²æŸ“æœåŠ¡ï¼ŒåŒäº‹CoreAnimationå°†è¦æ‰§è¡Œä»¥ä¸‹å…¶ä»–æ“ä½œï¼Œè§£ç åŠ¨ç”»è¿‡ç¨‹å°†è¦æ˜¾ç¤ºçš„å›¾ç‰‡çš„æ—¶é—´ç‚¹ã€‚ æäº¤ â€” æ‰“åŒ…æ‰€æœ‰çš„å›¾å±‚å’ŒåŠ¨ç”»å±žæ€§ï¼Œé€šè¿‡IPCå‘é€åˆ°æ¸²æŸ“æœåŠ¡è¿›è¡Œæ˜¾ç¤ºã€‚ å½“æ‰“åŒ…å›¾å±‚å’ŒåŠ¨ç”»å±žæ€§åˆ°æ¸²æŸ“æœåŠ¡è¿›ç¨‹ï¼Œä»–ä»¬ä¼šè¢«å‘åºåˆ—åŒ–æˆå¦ä¸€ä¸ªå«åšæ¸²æŸ“æ ‘çš„å›¾å±‚æ ‘ã€‚é€šè¿‡æ¸²æŸ“æ ‘ï¼Œæ¸²æŸ“æœåŠ¡å¯¹æ¯ä¸€å¸§åšå¦‚ä¸‹å·¥ä½œï¼š å¯¹æ‰€æœ‰å›¾å±‚å±žæ€§è®¡ç®—ä¸­é—´å€¼ï¼Œè®¾ç½®OpenGLå‡ ä½•å½¢çŠ¶æ¥æ‰§è¡Œæ¸²æŸ“ã€‚ åœ¨å±å¹•ä¸Šæ¸²æŸ“å¯é—´çš„ä¸‰è§’å½¢ æœ€åŽ2ä¸ªé˜¶æ®µåœ¨åŠ¨ç”»è¿‡ç¨‹ä¸­ä¸æ–­é‡å¤ï¼Œå‰5ä¸ªé˜¶æ®µCPUå¤„ç†ï¼Œæœ€åŽGPUæ‰§è¡Œã€‚å¼€å‘è€…èƒ½æŽ§åˆ¶çš„åªæœ‰å‰2ä¸ªé˜¶æ®µï¼šå¸ƒå±€å’Œæ˜¾ç¤ºã€‚CoreAnimationåœ¨å†…éƒ¨å¤„ç†å…¶ä»–äº‹ç‰©ï¼Œæ— æ³•æŽ§åˆ¶ã€‚åœ¨å¸ƒå±€å’Œæ˜¾ç¤ºé˜¶æ®µï¼Œå¯ä»¥å†³å®šå“ªäº›ç”±æ“ä½œç”±å“ªä¸ªUå¤„ç†ã€‚ GPUç›¸å…³æ“ä½œGPUè¿›è¡Œçš„ä¼˜åŒ–ï¼šé€šè¿‡é‡‡é›†å›¾ç‰‡å’Œå½¢çŠ¶ï¼Œè¿è¡Œå˜åŒ–ï¼Œåº”ç”¨çº¹ç†å’Œæ··åˆæŠŠä»–ä»¬è¾“é€åˆ°å±å¹•ä¸Šã€‚é™¤éžè‡ªå·±å®žçŽ°OpenGLç€è‰²å™¨ï¼Œä»Žæ ¹æœ¬ä¸Šè§£å†³ç¡¬ä»¶åŠ é€Ÿé—®é¢˜ï¼Œä½†å…¶ä»–å¤„ç†è¿˜æ˜¯éœ€è¦CPUè¿›è¡Œã€‚ å®½æ³›åœ°è¯´ï¼Œå¤§å¤šæ•°çš„CALayeréƒ½æ˜¯ç”±GPUç»˜åˆ¶çš„ã€‚å¦‚ç»˜åˆ¶è¾¹æ¡†å’Œåº•è‰²æˆ–æ˜¯è®¾ç½®contentså±žæ€§åˆ‡å‰²å›¾ç‰‡ç­‰ã€‚ ä½†æ˜¯å¤ªå¤šçš„äº‹æƒ…ä¼šé™ä½Žï¼ˆåŸºäºŽGPUï¼‰å›¾å±‚ç»˜åˆ¶ï¼š å¤ªå¤šçš„å‡ ä½•ç»“æž„ å…¶ç“¶é¢ˆä¸åœ¨GPUç»˜åˆ¶èƒ½åŠ›è€Œåœ¨äºŽCPUé€šè¿‡IPCæäº¤åˆ°æ¸²æŸ“è¿›ç¨‹æ—¶ï¼Œå¤ªå¤šçš„å›¾å±‚ä¼šå¼•å‘CPUç“¶é¢ˆã€‚ é‡ç»˜ï¼ˆæ¯ä¸€å¸§ç”¨ç›¸åŒçš„åƒç´ å¤šæ¬¡å¡«å……ï¼‰ ä¸»è¦ç”±é‡å çš„åŠé€æ˜Žå›¾å±‚å¼•èµ·ã€‚GPUçš„å¡«å……æ¯”çŽ‡æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥åº”é¿å…é‡ç»˜ã€‚å› ä¸ºiOSè®¾ç½®ä¸­GPUæœ‰å¾ˆé«˜çš„é‡ç»˜æ¯”çŽ‡ï¼Œå› æ­¤ä¸å¿…è¿‡åˆ†æ‹…å¿ƒã€‚ ç¦»å±ç»˜åˆ¶ å‘ç”Ÿåœ¨å½“ä¸èƒ½ç›´æŽ¥åœ¨å±å¹•ä¸Šç»˜åˆ¶ï¼Œå¿…é¡»ç»˜åˆ¶åˆ°ç¦»å±å›¾ç‰‡çš„ä¸Šä¸‹æ–‡ä¸­ã€‚ç¦»å±æ¸²æŸ“å‘ç”Ÿåœ¨åŸºäºŽCPUæˆ–æ˜¯GPUæ¸²æŸ“ï¼Œæˆ–æ˜¯ä¸ºç¦»å±å›¾ç‰‡åˆ†é…å†…å­˜ï¼Œä»¥åŠåˆ‡æ¢ä¸Šä¸‹æ–‡ï¼Œè¿™äº›éƒ½ä¼šé™ä½ŽGPUæ€§èƒ½ã€‚å¯¹äºŽç‰¹å®šå›¾å±‚çš„ä½¿ç”¨å¦‚åœ†è§’ã€å›¾å±‚é®ç½©ã€é˜´å½±æˆ–æ˜¯å›¾å±‚å…‰æ …åŒ–éƒ½ä¼šå¼ºåˆ¶CoreAnimation æå‰æ¸²æŸ“å›¾å±‚ã€‚ è¿‡å¤§çš„å›¾ç‰‡ å¦‚æžœå›¾ç‰‡çš„ç»˜åˆ¶è¶…è¿‡äº†GPUæ”¯æŒçš„2048 x 2048 æˆ–æ˜¯ 4096 x 4096çº¹ç†ï¼ŒGPUæ¯æ¬¡éœ€è¦åœ¨æ˜¾ç¤ºå›¾ç‰‡å‰è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒæ ·ä¼šé™ä½ŽGPUæ€§èƒ½ã€‚ CPUç›¸å…³æ“ä½œäºŽCoreAnimationç›¸å…³çš„å¤§éƒ¨åˆ†CPUæ“ä½œéƒ½å‘ç”Ÿåœ¨åŠ¨ç”»ä¹‹å‰ï¼Œè¿™æ„å‘³ç€å¾ˆå°‘ä¼šå› ä¸ºCPUæ“ä½œå°è±¡åŠ¨ç”»å¸§é¢‘ï¼Œä½†æ˜¯è‚¯èƒ½é€ æˆåŠ¨ç”»å»¶è¿Ÿæäº¤ï¼Œå¯¼è‡´æ˜¾ç¤ºæœ‰è¿Ÿé’æ„Ÿã€‚ é€ æˆCPUå»¶è¿ŸåŠ¨ç”»æ“ä½œï¼š å¸ƒå±€è®¡ç®— è¿‡äºŽå¤æ‚çš„å¸ƒå±€é€»è¾‘ï¼Œéœ€è¦æ¶ˆè€—CPUå¤§é‡çš„è®¡ç®—æ—¶é—´ã€‚iOS6ä¹‹åŽçš„è‡ªåŠ¨å¸ƒå±€å°¤ä¸ºæ˜Žæ˜¾ã€‚ è§†å›¾æ‡’åŠ è½½ iOSåªä¼šåœ¨è§†å›¾æŽ§åˆ¶å™¨çš„è§†å›¾æ˜¾ç¤ºåˆ°å±å¹•ä¸Šæ—¶æ‰ä¼šåŠ è½½å®ƒã€‚å› æ­¤å½“åŠ è½½å®Œæˆå‰ï¼Œéƒ½ä¸èƒ½ç›¸åº”å¯¹åº”çš„æ“ä½œã€‚ Core Graphics å¯¹è§†å›¾å®žçŽ°äº†drawRect:æˆ–drawLayer:inContext:æ–¹æ³•ï¼Œé€šè¿‡CoreGraphicsç»˜åˆ¶æ—¶ï¼Œéœ€è¦åˆ›å»ºç­‰å¤§å°çš„å¯„å®¿å›¾ï¼Œç»˜åˆ¶å®ŒæˆåŽé€šè¿‡IPCæäº¤åˆ°ç»˜åˆ¶æœåŠ¡ã€‚ è§£åŽ‹å›¾ç‰‡ PNGå’ŒJPEGåŽ‹ç¼©æŠ€æœ¯ä¼šä½¿å›¾ç‰‡å°äºŽç­‰è´¨é‡çš„ä½å›¾ï¼Œä½†åœ¨å±•ç¤ºæ—¶éœ€è¦è§£åŽ‹æ“ä½œã€‚iOSä¼šåœ¨çœŸæ­£ç»˜åˆ¶å›¾ç‰‡çš„æ—¶å€™æ‰è§£åŽ‹ï¼Œè¿‡å¤§çš„å›¾ç‰‡ä¼šæ¶ˆè€—CPUè§£åŽ‹æ—¶é—´ã€‚ å½“å›¾å±‚è¢«æˆåŠŸæ‰“åŒ…å‘é€åˆ°æ¸²æŸ“æœåŠ¡åŽï¼ŒCPUä»è¦è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š ä¸ºäº†æ˜¾ç¤ºå±å¹•ä¸Šçš„å›¾å±‚ï¼ŒCoreAnimationå¿…é¡»æ¸²æŸ“æ ‘ä¸­æ¯ä¸ªå¯è§å›¾å±‚é€šè¿‡OpenGLå¾ªçŽ¯è½¬åŒ–ä¸ºçº¹ç†ä¸‰è§’æ¿ã€‚ç”±äºŽGPUä¸çŸ¥é“æ¸²æŸ“æ ‘å±‚çº§å…³ç³»ï¼Œå› æ­¤æ˜¯ç”±CPUå¤„ç†è½¬æ¢æ“ä½œã€‚CPUè½¬æ¢å·¥ä½œå’Œå¤„ç†çš„å›¾å±‚æ•°é‡ç¨‹æ­£æ¯”ï¼Œå¦‚æžœå›¾å±‚å…³ç³»è¿‡äºŽå¤æ‚ ï¼Œä¼šå¯¼è‡´CPUæ¸²æŸ“æ¯ä¸€å¸§ã€‚ IOæ“ä½œè¿˜æœ‰ä¸€é¡¹æ¶‰åŠåˆ°çš„å°±æ˜¯IOç›¸å…³æ“ä½œï¼Œä¸Šä¸‹æ–‡ä¸­çš„IOæŒ‡çš„æ˜¯å†…å­˜æˆ–ç½‘ç»œæŽ¥å£çš„ç¡¬ä»¶è®¿é—®ã€‚2ä¸ªæŽ§åˆ¶å™¨é—´çš„è¿‡åº¦å¯èƒ½éœ€è¦ä»Žnibæ–‡ä»¶ä¸­æ‡’åŠ è½½ï¼Œæˆ–æ˜¯æ—‹è½¬ä¸€ä¸ªå ç”¨å†…å­˜è¿‡å¤§çš„å›¾ç‰‡ï¼Œéœ€è¦åŠ¨æ€çš„æ»šåŠ¨åŠ è½½ã€‚ IOåŠ è½½ç›¸å¯¹å†…å­˜æ“ä½œæ›´æ…¢ï¼Œå¦‚æžœæ¶‰åŠåŠ¨ç”»å°±ä¼šæ˜¯ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œä¹‹åŽäº†è§£åˆ°å¤šçº¿ç¨‹ã€ç¼“å­˜å’ŒæŠ•æœºåŠ è½½ç­‰è§£å†³æ–¹æ¡ˆã€‚ é«˜æ•ˆç»˜å›¾è½¯ä»¶ç»˜åˆ¶é€šå¸¸åœ¨Core Animationä¸­ä½¿ç”¨ç»˜å›¾ä»£æ›¿è½¯ä»¶ç»˜å›¾ï¼ˆä¸é€šè¿‡GPUåä½œçš„ç»˜å›¾ï¼‰ã€‚iOSä¸­ç»˜å›¾é€šå¸¸ç”±Core Graphics æ¡†æž¶æ¥å®Œæˆã€‚åœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹ç›¸æ¯”CoreAnimationå’ŒOpenGLï¼ŒCore Graphicsè¿è¡Œé€Ÿåº¦ä¼šæ…¢ä¸€ä¸‹ã€‚ Core Graphics ä¸ä»…æ•ˆçŽ‡ä½Žä¸‹ï¼Œè¿˜ä¼šæ¶ˆè€—å¯è§‚çš„å†…å­˜ã€‚å·²å…¨å±ç»˜åˆ¶ä¸ºä¾‹ï¼Œå±å¹•åƒç´ ä¹˜ä»¥æ”¾å¤§å€æ•°å°±æ˜¯ç»˜åˆ¶çš„å›¾ç‰‡å¤§å°ã€‚æ¯æ¬¡ç»˜åˆ¶éƒ½è¦æ“¦é™¤å†…å­˜ï¼Œç„¶åŽé‡æ–°åˆ†é…ã€‚ è½¯ä»¶ç»˜åˆ¶ä»£ä»·é«˜æ˜‚ï¼Œé™¤éžå¿…è¦ã€‚å°½é‡é¿å…é‡ç»˜è§†å›¾ã€‚æé«˜æ€§èƒ½çš„ç§˜è¯€ å°½é‡é¿å…åŽ»ç»˜åˆ¶ çŸ¢é‡å›¾å½¢åœ¨ä½¿ç”¨Core Graphicsè¿›è¡Œç»˜åˆ¶æ—¶ï¼Œä¸èƒ½å•çº¯çš„æ—¶å€™å›¾ç‰‡æˆ–å›¾å±‚ç»˜åˆ¶å®Œæˆçš„ å¦‚ä¸‹ï¼š ä»»æ„å¤šè¾¹å½¢ æ–œçº¿æˆ–æ›²çº¿ æ–‡æœ¬ æ¸å˜ å½“å®žçŽ°ç®€å•ç»˜åˆ¶å…¥ç”»æ¿å·¥ä½œæ—¶ï¼Œå¯ä½¿ç”¨ç‰¹æ®Šçš„layerå±‚ï¼Œä»£æ›¿Core Graphicsè¾¾åˆ°èŠ‚çœå†…å­˜æé«˜ç»˜åˆ¶æ•ˆçŽ‡ è„çŸ©å½¢ä¸ºäº†å‡å°‘ä¸å¿…è¦çš„ç»˜åˆ¶ï¼ŒMac OSå’ŒiOSè®¾å¤‡ä¼šæŠŠå±å¹•åˆ†æˆéœ€è¦é‡ç»˜å’Œä¸éœ€è¦é‡ç»˜çš„åŒºåŸŸã€‚éœ€è¦é‡ç»˜çš„åŒºåŸŸç§°ä¸ºè„åŒºåŸŸ ã€‚åœ¨å®žé™…åº”ç”¨ä¸­ï¼Œé‰´äºŽåŒºåˆ†éžçŸ©å½¢åŒºåŸŸè¾¹ç•Œçš„å‰ªè£å’Œæ··åˆå¤æ‚æ€§ï¼Œé€šå¸¸ä¼šåŒºåˆ†å‡ºåŒ…å«æŒ‡å®šè§†å›¾çš„çŸ©å½¢ä½ç½®ï¼Œè¿™ä¸ªä½ç½®å°±æ˜¯è„çŸ©å½¢ ã€‚ å› æ­¤å¯ä»¥é€šè¿‡è„çŸ©å½¢å‡å°‘å›¾å½¢é‡ç»˜çš„åŒºåŸŸï¼Œå·²ç¼“è§£å†…å­˜å’ŒCPUçš„åŽ‹åŠ›ã€‚ è°ƒç”¨setNeedDispayInRect:ä¼ å…¥éœ€è¦é‡ç»˜çš„åŒºåŸŸï¼Œåœ¨drawRect:æˆ–drawLayer:InContext:æ–¹æ³•ä¸­å¯¹è¯¥åŒºåŸŸè¿›è¡Œç»˜åˆ¶ï¼ŒCPUä¼šå¿½ç•¥è¶…å‡ºéƒ¨åˆ†ã€‚å¯ä»¥é€šè¿‡CGContextGetClipBoundingBox()å‡½æ•°ä»Žä¸Šä¸‹æ–‡ä¸­èŽ·å–åˆ°å…·ä½“çš„ç»˜åˆ¶åŒºåŸŸçš„å¤§å°ã€‚ ç›¸å¯¹äºŽCoreGraphicsçš„é‡ç»˜ï¼Œè£å‰ªå‡ºæ¥çš„åŒºåŸŸå¯é¿å…ä¸å¿…è¦çš„æ“ä½œã€‚ä½†æ˜¯å¦‚æžœé‡ç»˜æœºåˆ¶è¿‡äºŽå¤æ‚ï¼Œè¿˜æ˜¯åº”è¯¥å€ŸåŠ©CoreGraphicsè¿›è¡Œç»˜åˆ¶ã€‚ä¸ºäº†é¿å…åœ¨é‡ç»˜åŒºåŸŸå†…é‡ç»˜å·²å­˜åœ¨çš„ç»˜åˆ¶ï¼Œé¿å…é‡å¤ï¼Œå¯ä»¥é€šè¿‡CGRectIntersectsRect()ç¡®å®šæ˜¯å¦åŒ…å«åœ¨è¿›è¡Œç»˜åˆ¶ å¼‚æ­¥ç»˜åˆ¶UIKitå•çº¿ç¨‹çš„æœ¬è´¨ï¼Œè¦æ±‚ç»˜åˆ¶ä¸€å®šåœ¨ä¸»çº¿ç¨‹ï¼Œå› æ­¤ç»˜åˆ¶å¯èƒ½ä¼šå½±å“åˆ°ç”¨æˆ·äº¤äº’ã€‚UIKitæä¾›äº†2ç§æ–¹å¼ç»˜åˆ¶ï¼šCATiledLayerå’ŒdrawsAsynchronouslyã€‚ CATiledLayeræ¯ä¸ªCATiledLayerçš„åŒºå—ï¼Œéƒ½æ”¯æŒåŒæ—¶è°ƒç”¨drawLayer:InContext:æ–¹æ³•ï¼Œé¿å…äº†ç»˜åˆ¶å½±å“ç”¨æˆ·äº¤äº’ï¼Œæ˜¯å¾ˆä¼˜ç§€çš„å¼‚æ­¥ç»˜åˆ¶æ–¹æ¡ˆã€‚ drawsAsychronouslydrawsAsychronouslyä¸åŒäºŽå¼‚æ­¥ç»˜åˆ¶ï¼Œåªæ˜¯å»¶è¿Ÿæäº¤ã€‚ç»˜åˆ¶ä»å¤„äºŽä¸»çº¿ç¨‹ï¼Œä½†æ˜¯Contextå¯¹è±¡ä¸ä¼šç«‹åˆ»ç»˜åˆ¶ï¼Œè€Œæ˜¯é€šè¿‡é˜Ÿåˆ—é€æ­¥ç»˜åˆ¶ã€‚ä¹Ÿå¯ä»¥é¿å…ç»˜åˆ¶å½±å“ç”¨æˆ·äº¤äº’æ“ä½œã€‚ IOæ“ä½œå…³äºŽå›¾ç‰‡æ“ä½œä¸­æœ€æ¶ˆè€—CPUæ—¶é—´çš„å°±æ˜¯è§£åŽ‹ï¼Œä¸€èˆ¬å…¶ä»–æ–¹å¼è¾¾åˆ°å»¶è¿Ÿè§£åŽ‹å·²çŽ¯èŠ‚CPUåŽ‹åŠ› å»¶è¿Ÿè§£åŽ‹ä¸€èˆ¬ä½¿ç”¨ä¸‰ç§æ–¹å¼å»¶è¿Ÿè§£åŽ‹ è°ƒç”¨imageWithName:æ–¹æ³•ï¼Œå’ŒimageWithContentsOfFile:ä¸åŒã€‚ä¼šåœ¨åŠ è½½å›¾ç‰‡ä¹‹åŽç«‹å³è¿›è¡Œè§£åŽ‹ã€‚(ä½†åªå¯¹å­˜åœ¨åœ¨åº”ç”¨èµ„æºæŸå†…çš„å¯¹è±¡ç®¡ç”¨) æŠŠå›¾ç‰‡è®¾ç½®ä¸ºå›¾å±‚å†…å®¹ï¼Œç±»ä¼¼äºŽUIimageViewçš„imageã€‚ä½†æ˜¯é‡‡ç”¨ä¸»çº¿ç¨‹ï¼Œå‡ ä¹Žæ²¡æœ‰æå‡ã€‚ æå‰è§£åŽ‹ä½¿ç”¨UIKitåŠ è½½å›¾ï¼Œå¹¶ç«‹åˆ»åœ¨CGContextç»˜åˆ¶ã€‚å›¾ç‰‡éœ€è¦åœ¨ç»˜åˆ¶å‰è§£åŽ‹å®Œæˆï¼Œå› æ­¤å¼ºè°ƒäº†è§£åŽ‹çš„åŠæ—¶æ€§å’Œæœ‰æ•ˆæ€§ã€‚ç»˜åˆ¶å›¾ç‰‡å¯ä»¥åœ¨åŽå°ç»˜åˆ¶ï¼Œä¸å¿…è¦é˜»å¡žçº¿ç¨‹ã€‚ ä¸€æŠŠä½¿ç”¨å¦‚ä¸‹ä¸¤ç§æ–¹å¼ é€šè¿‡CoreGraphicsç»˜åˆ¶å›¾ç‰‡çš„ä¸€ä¸ªåƒç´ ï¼Œå› ä¸ºç»˜åˆ¶å‡ ä¹Žä¸èŠ±æ—¶é—´ï¼Œå¹¶ä¸”è§£åŽ‹äº†å›¾ç‰‡ã€‚å¼ºè°ƒç»˜åˆ¶çš„ä»»æ„æ€§ã€‚å¯ä»¥é€šè¿‡å•çº¯ä¾é ç³»ç»Ÿçš„å†…å­˜ç®¡ç†ã€‚ é€šè¿‡CoreGraphicsç»˜åˆ¶æ•´å¼ å›¾ç‰‡ï¼Œç”¨ä»¥ä¿å­˜å’Œæ›¿ä»£åŽŸæœ‰å›¾ç‰‡ã€‚å¯ä»¥å¯¹ç»˜åˆ¶è¿›è¡Œä¼˜åŒ–ã€‚ä½†æ˜¯éœ€è¦æŒæœ‰å›¾ç‰‡ï¼Œè€Œä¸æ˜¯å•çº¯ä¾é ç³»ç»Ÿå†…å­˜ç®¡ç†ã€‚ CATiledLayeråˆ©ç”¨CACATiledLayerå¼‚æ­¥ç»˜åˆ¶ï¼Œé¿å…é˜»å¡žçº¿ç¨‹ã€‚ä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜Žæ˜¾ ç¼“å­˜ç®—æ³•å’Œå¼‚æ­¥ç»˜åˆ¶æœºåˆ¶ä¸å¯æŽ§åˆ¶ï¼Œæ²¡æœ‰é¢„ç•™æŽ¥å£ æ¯æ¬¡éƒ½éœ€è¦è°ƒç”¨ç»˜åˆ¶æœºåˆ¶ï¼Œå³ä¾¿å¤§å°åˆé€‚å¹¶ä»¥è§£åŽ‹ç¼© ä½¿ç”¨æ—¶çš„æ³¨æ„ç‚¹ï¼š ä½¿ç”¨çš„æ—¶å€™titleSzieæ˜¯åƒç´ ï¼Œè€Œä¸æ˜¯å±å¹•ä¸Šçš„ç‚¹ã€‚å› æ­¤éœ€è¦åŒ¹é…å±å¹•åƒç´  ç”±äºŽæ˜¯ç›¸åŒçš„ä»£ç†æ–¹æ³•ï¼Œå› æ­¤éœ€è¦åœ¨drawLayer:inContext:ä¸­è¿›è¡ŒåŒºåˆ† åˆ†è¾¨çŽ‡äº¤æ¢é«˜åˆ†è¾¨å±å¹•èƒ½å±•ç¤ºæ›´å¥½çš„æ•ˆæžœï¼Œä½†æ˜¯å¯¹äºŽåŠ¨å›¾åŒºåˆ«ä¸å¤§ï¼Œå› æ­¤å¯ä»¥åœ¨æ»šåŠ¨è§†å›¾çš„ä»£ç†ä¸­ç”¨ä½Žåˆ†è¾¨çŽ‡çš„å›¾ç‰‡ä»£æ›¿é«˜åˆ†è¾¨çŽ‡çš„å›¾ç‰‡å·²è¾¾åˆ°ä¼˜åŒ–æ•ˆæžœã€‚ ç¼“å­˜ç¼“å­˜çš„å®žè´¨ï¼šå°±æ˜¯å­˜å‚¨æ˜‚è´µçš„è®¡ç®—ç»“æžœåœ¨å†…å­˜ä¸­ï¼Œä»¥ä¾¿è®¿é—®ï¼Œå› ä¸ºè¯»å–å†…å­˜å¾ˆå¿«ã€‚é—®é¢˜çš„æœ¬è´¨å°±æ˜¯æƒè¡¡æ€§èƒ½å’Œæœ‰é™çš„å†…å­˜ã€‚ +imageNamed:æ–¹æ³• ä¼˜ç‚¹å¾ˆæ˜Žæ˜¾ï¼Œä¼šç«‹åˆ»è¿›è¡Œè§£åŽ‹ï¼Œå¹¶åœ¨å†…å­˜ä¸­ä¿å­˜ç¼“å­˜ã€‚ ä»…èƒ½åŠ è½½èµ„æºæŸä¸­çš„èµ„æº ç¼“å­˜å¤§å›¾åŽï¼Œä¸å¯èƒ½é‡Šæ”¾ ç¼“å­˜æœºåˆ¶ä¸å¯æŽ§ è‡ªå®šç¼“å­˜æž„å»ºä¸€ä¸ªç¼“å­˜æœºåˆ¶å¾ˆå›°éš¾ï¼Œç¼“å­˜å’Œå‘½åæ˜¯æœ€éš¾çš„ è‡ªå®šä¹‰ç¼“å­˜åº”æ³¨æ„çš„ç‚¹ åˆé€‚çš„ç¼“å­˜é—´ï¼Œé¿å…é‡å¤ åˆç†çš„åˆ†ç±»ç¼“å­˜å’Œè§£åŽ‹åˆ†é…ï¼Œå½“åŠ è½½æ¯”è¾ƒå¤§çš„è€—æ—¶èµ„æºæ—¶ï¼Œåº”æå‰ç»˜åˆ¶å’Œè§£åŽ‹ ç¼“å­˜å¤±æ•ˆæœºåˆ¶ å†…å­˜å›žæ”¶æœºåˆ¶ NSCacheUIKitæä¾›çš„å’ŒNSDictionaryç›¸ä¼¼çš„é›†åˆç±»ï¼Œå¯è®¾ç½®æœ€å¤§ç¼“å­˜ï¼Œåœ¨å†…å­˜åƒç´§æ—¶ä¼šè‡ªåŠ¨ä¸¢å¼ƒå¯¹è±¡ç­‰ä¼˜ç‚¹ã€‚ æ‰€æœ‰ä½¿ç”¨NSDictionaryçš„åœ°æ–¹éƒ½æ˜¯ç”¨NSCacheã€‚ å›¾å±‚æ€§èƒ½éšå¼ç»˜åˆ¶é™¤äº†åˆ©ç”¨CoreGraphicsç›´æŽ¥åœ¨Contextæ˜¾ç¤ºç»˜åˆ¶å¯„å®¿å›¾ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼éšå¼ç»˜åˆ¶ ä½¿ç”¨ç‰¹å®šçš„å›¾å±‚å±žæ€§ ç‰¹å®šçš„è§†å›¾ ç‰¹å®šçš„å›¾å±‚å­å±‚ æ–‡æœ¬CATextLayerç›¸å¯¹äºŽUILabelæœ‰æ›´å¥½çš„ç»˜åˆ¶æ€§èƒ½ï¼Œå› æ­¤å¤§æ–‡æœ¬åº”ä¼˜å…ˆè€ƒè™‘CATextLayerã€‚åº”å°½é‡é¿å…ä¿®æ”¹æ–‡æœ¬çš„frameï¼Œä¿®æ”¹frameä¼šåœ¨å¯¼è‡´æ–‡æœ¬é‡ç»˜ã€‚ å…‰æ …åŒ–å¯ç”¨CALayerçš„shouldRasterizeå±žæ€§ï¼Œå¯ä»¥è§£å†³é€æ˜Žå›¾å±‚çš„æ··åˆå¤±çµé—®é¢˜ã€‚ å¯ç”¨shouldRasterizeåŽï¼Œä¼šåœ¨å±å¹•å¤–ç»˜åˆ¶å¹¶ç¼“å­˜ï¼Œä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜å’Œè®¡ç®—æ—¶é—´ï¼Œä½†æ˜¯ä¼šæ˜¯å±•ç¤ºæ›´ä¸ºé¡ºç•…ï¼Œç›¸å¯¹äºŽé‡ç»˜æ¥è¯´æ›´ä¸ºåˆç†ã€‚åº”é¿å…åœ¨ä¸æ–­å˜åŒ–çš„å›¾å±‚ä¸Šä½¿ç”¨ï¼Œå¦åˆ™ä¼šä½¿å†…å­˜æ›´ä¸ºä¸åˆç†ã€‚ ç¦»å±æ¸²æŸ“å½“å›¾å±‚çš„æ··åˆä½“è¢«æŒ‡å®šä¸ºåœ¨é¢„åˆæˆå‰ä¸èƒ½ç›´æŽ¥åœ¨å±å¹•ä¸Šç»˜åˆ¶æ—¶ï¼Œå°±ä¼šå‡ºçŽ°ç¦»å±æ¸²æŸ“ã€‚ä½†æ˜¯ç¦»å±æ¸²æŸ“ç›¸å¯¹äºŽå…‰æ …åŒ–æ¥è¯´ï¼Œæ²¡æœ‰å¾ˆå¤§çš„å†…å­˜å’Œç»˜åˆ¶æ¶ˆè€—ï¼Œç»“æžœæ²¡æœ‰ç¼“å­˜ï¼Œå¹¶ä¸”ä¼šè¢«é‡Šæ”¾ã€‚å› æ­¤å¯ä»¥å¼€å¯å…‰æ …åŒ–ä½œä¸ºä¼˜åŒ–æ–¹å¼ï¼Œä½†å‰ææ˜¯å›¾å±‚ä¸ä¼šè¢«é‡å¤ç»˜åˆ¶ã€‚å¯¹åº”é‚£äº›éœ€è¦åŠ¨ç”»å’Œç¦»å±ç»˜åˆ¶çš„å›¾å±‚æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨CAShapeLayerã€contentCenterå’ŒshadowPathæ¥åˆ°ç›¸åŒçš„æ•ˆæžœå¹¶æé«˜æ€§èƒ½ã€‚ å¸¸è§å¼•å‘ç¦»å±æ¸²æŸ“çš„æ–¹å¼ contentRadiuså’ŒmaskToBoundsä¸€èµ·ä½¿ç”¨ å›¾å±‚è’™ç‰ˆ é˜´å½± CAShapeLayerç›¸å¯¹äºŽcontentRadiuså’ŒmaskToBoundsï¼Œä½¿ç”¨CAShapeLayerå’ŒUIBezierPathä¸ä¼šé€ æˆç¦»å±æ¸²æŸ“é—®é¢˜ã€‚ å¯ä¼¸ç¼©çš„å›¾ç‰‡ä½¿ç”¨contentCenterå¯ä»¥é€šè¿‡ç»˜åˆ¶æ‹‰ä¼¸åœ†è§’å›¾ç‰‡è¾¾åˆ°æ›´ä¸ºè‰¯å¥½çš„æ€§èƒ½ï¼Œå› ä¸ºç»˜åˆ¶ä¸€ä¸ªå›¾ç‰‡ä»…éœ€è¦3*3çš„ç½‘æ ¼ç»˜åˆ¶ï¼Œä»…ä»…éœ€è¦18ä¸ªä¸‰è§’å½¢ã€‚ç”šè‡³å¯ä»¥ä½¿ç”¨contentCenterå®žçŽ°é˜´å½±æ•ˆæžœã€‚ shadowPathåœ¨ç»˜åˆ¶ä¸€ä¸ªç®€å•çš„å‡ ä½•çŸ©å½¢æˆ–åœ†è§’çŸ©å½¢æ—¶ï¼Œå‡è®¾ä¸åŒ…å«ä»»ä½•é€æ˜Žå›¾å±‚ï¼Œåˆ›å»ºé˜´å½±ç›¸å¯¹å®¹æ˜“ï¼ŒCoreAnimationåˆ›å»ºé˜´å½±ä¹Ÿç›¸å¯¹ç®€å•ã€‚ä½†æ˜¯å¦‚æžœæ˜¯å¤æ‚å›¾å½¢å¯ä»¥è€ƒè™‘å…ˆç”Ÿæˆå¯¹åº”çš„é˜´å½±å›¾ç‰‡ã€‚å¯ä»¥èŠ‚çº¦æ€§èƒ½ã€‚ æ··åˆå’Œè¿‡åº¦ç»˜åˆ¶GPUæ¯ä¸€å¸§å¯ç»˜åˆ¶çš„åƒç´ éƒ½æœ‰ä¸€ä¸ªæœ€å¤§é™åˆ¶(å³æ‰€è°“çš„fill rate)ï¼Œè¿™ä¸ªæƒ…å†µä¸‹å¯ä»¥ç»˜åˆ¶æ•´ä¸ªå±å¹•çš„æ‰€æœ‰åƒç´ ã€‚ç”±äºŽé‡å å›¾å±‚çš„å…³ç³»éœ€è¦ä¸åœç»˜åˆ¶çš„åŒä¸€åŒºåŸŸæ—¶ï¼Œå°±ä¼šå‡ºçŽ°æŽ‰å¸§çŽ°è±¡ã€‚ GPUä¼šæ”¾å¼ƒå®Œå…¨è¢«é®è”½çš„å›¾å±‚ï¼Œåˆå¹¶é€æ˜Žçš„é‡å å›¾å±‚ä¼šå¾ˆæ¶ˆè€—è®¡ç®—æ—¶é—´ï¼Œä¸ºäº†åŠ é€Ÿå¤„ç†è¿›ç¨‹ï¼Œå°½é‡ä¸å®žç”¨é€æ˜Žå›¾å±‚ã€‚ å¯ä»¥é€šè¿‡ä¼˜åŒ–å¦‚ä¸‹å±žæ€§è¿›è¡ŒåŠ é€Ÿä¼˜åŒ– ç»™è§†å›¾çš„backgroundColorè®¾ç½®ä¸€ä¸ªå›ºå®šçš„ä¸é€æ˜Žè‰² è®¾ç½®ä¸é€æ˜Žå±žæ€§opaqueä¸ºtrue å¯ä»¥é€šè¿‡shouldRasterizeå±žæ€§å°†ä¸€ä¸ªä¸é€æ˜ŽåŒºåŸŸè®¾ç½®ä¸ºå›¾ç‰‡ï¼Œä»¥å‡å°‘é‡ç»˜æé«˜æ•ˆçŽ‡ã€‚ å‡å°‘å›¾å±‚æ•°é‡ç”±äºŽç»˜åˆ¶ä½¿ç”¨è¿‡IPCæ‰“åŒ…æ¸²æŸ“ï¼Œæœ€åŽç”±OpenGLè½¬æ¢ä¸ºä¸‰è§’å½¢ï¼Œç”±äºŽæ¯æ¬¡ç»˜åˆ¶çš„å›¾å±‚æ•°é‡ä¹Ÿæœ‰æœ€å¤§å›¾å±‚ä¸Šé™ï¼Œå› æ­¤åº”å°½é‡å‡å°‘å›¾å±‚æ•°é‡ï¼Œè¾ƒå°‘è®¡ç®—æ—¶é—´ã€‚ è£å‰ªå†è¿›è¡Œä¼˜åŒ–ä¹‹å‰ï¼Œéœ€è¦ç¡®è®¤ä¸æ˜¯åœ¨åˆ›å»ºä¸€äº›ä¸å¯è§å›¾å±‚ã€‚å›¾å±‚åœ¨ä»¥ä¸‹è¯·æ¬¾ä¸å¯è§ã€‚ å›¾å±‚åœ¨å±å¹•è¾¹ç¼˜æˆ–çˆ¶å›¾å±‚è¾¹ç¼˜ä¹‹å¤– åœ¨ä¸€ä¸ªå®Œå…¨ä¸é€æ˜Žçš„å›¾å±‚ä¹‹åŽ å®Œå…¨é€æ˜Ž CoreAnimationå¾ˆæ“…é•¿å¤„ç†å¯¹è§†è§‰æ•ˆæžœæ— æ„ä¹‰çš„å›¾å±‚ï¼Œä½†æ˜¯åˆ›å»ºæ—¶åº”è¯¥å¯ä»¥ç¡®å®šå›¾å±‚æ˜¯å¦å¯è§ã€‚åº”é¿å…åˆ›å»ºå’Œé…ç½®ä¸å¯è§å›¾å±‚ã€‚ å¯¹è±¡å›žæ”¶åŸºäºŽUITableViewã€UICollectionViewå’ŒMKMapViewéƒ½åˆ©ç”¨äº†å¯¹è±¡æ± æ¦‚å¿µï¼Œå³é‡å¤åˆ©ç”¨è€Œä¸æ˜¯åˆ›å»ºåŠ å›žæ”¶æœºåˆ¶ï¼Œå¯ä»¥æœ‰æ•ˆçš„é¿å…é‡å¤åˆ›å»ºèŠ‚çº¦è®¡ç®—æ—¶é—´ã€‚ CoreGraphicsè™½ç„¶ç»˜åˆ¶çŽ°å¯¹äºŽGPUå›¾å±‚æ•°æ¥è¯´æ›´ä¸ºè€—æ—¶ï¼Œä½†æ˜¯å¦‚æžœå›¾å±‚æ•°é‡è¿‡åº¦ï¼Œé€šè¿‡ç»˜åˆ¶è¾ƒå°‘å›¾å±‚æ•°é‡ï¼Œä¹Ÿå¯ä»¥å‡å°‘å­å›¾å±‚çš„å…³ç³»ã€‚ -renerInContextæ–¹æ³•é€šè¿‡CALayerçš„renerInContextæ–¹æ³•ï¼Œå¯ä»¥èŽ·å–å¯¹åº”å›¾å±‚çš„é™æ€å›¾ç‰‡ï¼Œå¯ä»¥å°†å®ƒèµ‹å€¼layerçš„contentså®Œå…¨é®è”½åŽé¢çš„å›¾å±‚æ—¢å¯ä»¥ï¼Œç›¸å¯¹äºŽCoreAnimationç»´æŠ¤çš„å¤æ‚å›¾å±‚æ ‘ï¼Œè¿™æ ·å­å®¢è§‚èŠ‚çº¦äº†æ€§èƒ½ã€‚]]></content>
      <categories>
        <category>CoreAnimation</category>
      </categories>
      <tags>
        <tag>Animation</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ–°çš„æ ¼å¼åŒ–æ–¹å¼]]></title>
    <url>%2F2017%2F06%2F28%2F%E6%96%B0%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%96%B9%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡é“¾æŽ¥ç‚¹å‡»è·³è½¬ åŽŸæ–‡æ ‡é¢˜æ˜¯Swift 4 Codable, JSON Handling Made Easy å‰¯æ ‡é¢˜ Data Can Make You Cryï¼ˆæœ‰æ²¡æœ‰è¿™ä¹ˆæ¿€åŠ¨ï¼‰ çŽ°åœ¨å¯ä»¥ç”¨å¾ˆå°‘çš„ä»£ç å®žçŽ°jsonçš„ç¼–è¯‘ä¸Žåç¼–è¯‘äº†ã€‚è™½ç„¶æœ‰å¤§é‡çš„ç¬¬ä¸‰æ–¹åº“å¯ä»¥å®žçŽ°è¯¥åŠŸèƒ½ï¼Œä½†æ˜¯Swiftç³»ç»Ÿåº“ä¹Ÿå®žçŽ°äº†è¯¥åŠŸèƒ½ã€‚ä¸‹é¢äº†è§£ä¸€ä¸‹æ–°çš„åè®®ã€‚ éœ€æ±‚ çŽ°åœ¨æœ‰ä¸€ä¸ªå°éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦å‘é€jsonæ•°æ®å¹¶é‡Šæ”¾å¹¶é‡Šæ”¾å†…å­˜ã€‚åœ¨Swift3.0æ—¶æˆ‘ä»¬éœ€è¦å†™å¤§é‡çš„å·¥åŽ‚ä»£ç åŽ»è¿›è¡Œç¼–è¯‘ä¸Žåç¼–è¯‘ã€‚çŽ°åœ¨ï¼Œå½“æ•°æ®ç»“æž„éœ€è¦æ”¹å˜æˆ–è€…å¿…é¡»æ”¹å˜å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦æ¯æ¬¡é‡å†™ä»£ç ã€‚ å¯¹äºŽå¦‚æ­¤æ—¶å°šçš„è¯­è¨€ï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„è§£å†³æ–¹å¼ï¼Ÿ è§£å†³æ–¹æ¡ˆSwiftç»™å‡ºäº†æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œæ›´å¥½çš„æ˜¯ï¼Œä»…éœ€ä¸€ä¸ªå­—ã€‚Codableç»§æ‰¿äº†2ä¸ªåè®®çš„ä¸€ä¸ªå­—ï¼Œä»…ä»…éœ€è¦ç»§æ‰¿Codableå¹¶é€šè¿‡åˆ›å»ºçš„ç¼–è¯‘æˆ–åç¼–è¯‘å¯¹è±¡ï¼Œç¼–è¯‘å™¨ä¼šå¾ˆä¼˜ç§€çš„å®Œæˆæ˜ å°„æ“ä½œã€‚ ç¬¬ä¸€æ­¥å‡è®¾æˆ‘ä»¬æœ‰ä¸ªPersonçš„ç»“æž„ä½“ï¼Œéœ€è¦é€šè¿‡ç¼–è¯‘å™¨å®žçŽ°ç»“æž„ä½“åˆ°jsonæ•°æ®çš„ç¼–è¯‘ï¼Œç¬¬ä¸€æ­¥å½“ç„¶æ˜¯åˆ›å»ºç»“æž„ä½“ã€‚ Struct Person : Codable{ enum Gender:String,Codable { case Male,Female,Alien } var name : String var userName : String var gender:[Gender] } ç»“æž„ä½“åŒ…å«ä¸€äº›å˜é‡ï¼Œåƒæ˜¯name,username,genderæ˜¯ä¸€ä¸ªæžšä¸¾ï¼Œç”¨äºŽè¡¨ç¤ºæœ‰é™çš„æœ‰é™åˆ¶çš„æ•°æ®é€‰é¡¹ã€‚åˆ›å»ºä¸€ä¸ªPersonçš„å®žä¾‹å¯¹è±¡ let person = Person(name : &quot;Peter&quot;,userName : &quot;pwitham&quot;,gender :[.Alien]) ç¼–è¯‘ä¸ºjsonåœ¨å®žçŽ°è½¬åŒ–ä¹‹å‰ï¼Œéœ€è¦åˆ›å»ºJSONEncoderå®žä¾‹å¯¹è±¡ï¼Œé€šè¿‡åˆ›å»ºçš„æ•°æ®å¯¹è±¡ä¿å­˜ç¼–è¯‘å®žä¾‹ï¼Œè¿™é‡Œé€šè¿‡Stringå±•ç¤ºå¯¹åº”çš„æ•°æ® let jsonencoder = JSONEncoder() let jsonData = jsonencoder.encode(person) let stringData = String(data : jsonData, encoding : .utf8) printf(stringData) åç¼–è¯‘jsonåœ¨åç¼–è¯‘ä¹‹å‰ï¼Œéœ€è¦åˆ›å»ºJSONDecoderå®žä¾‹å¯¹è±¡ï¼Œé€šè¿‡è¯¥å¯¹è±¡åç¼–è¯‘å¹¶åˆ›å»ºä¸€ä¸ªå®¹å™¨ä¿å­˜æ•°æ®ã€‚æœ€åŽæ‰“å°ï¼ŒæŸ¥çœ‹æ•°æ®ç»“æž„ let jsonDecoder = JSONDecoder() let decodePerson = try jsonDecoder.decoder(Person.self,from:jsonData) printf(decodePerson) åŒ…è£…çŽ°åœ¨è¯¥åè®®å·²ç»ç¿˜é¦–ä»¥ç›¼ã€‚å½“ä¿®æ”¹ç»“æž„ä½“æ—¶ï¼ŒSwift4ä¼šè‡ªåŠ¨æ˜ å°„è½¬æ¢æˆå¯¹åº”çš„æ•°æ®ç»“æž„ã€‚ åœ¨ä¼—å¤šç¬¬ä¸‰æ–¹åº“ä¸­ï¼Œä¹Ÿè®¸è¿™æ‰æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚ ï¼ˆä¸æ˜¯å¾ˆåŒæ„ï¼Œæˆ‘ä½¿ç”¨ç¬¬ä¸‰æ–¹åªæ˜¯ä¸ºäº†æ¯”è¾ƒå…¨é¢çš„æ•°æ®ç±»åž‹è½¬åŒ–ï¼Œé¬¼çŸ¥é“åŽå°ä¼ è¿‡æ¥çš„æ•°æ®åˆ°åº•æ˜¯ä»€ä¹ˆæ ¼å¼çš„ï¼‰]]></content>
      <categories>
        <category>Swift</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæ˜¯é—­åŒ…]]></title>
    <url>%2F2017%2F06%2F18%2F%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF%E9%97%AD%E5%8C%85%2F</url>
    <content type="text"><![CDATA[åŽŸæ–‡é“¾æŽ¥å›½å¤–å‹äººçš„åšå®¢ å•çº¯çš„æˆ‘ä»¥ä¸ºæœ‰åº•å±‚ä»£ç å¯çœ‹äº†ï¼Œç»“æžœã€‚ã€‚ã€‚è¯´å¥½çš„åªè®¨ä»€ä¹ˆæ˜¯é—­åŒ…ã€‚ä»¥ä¸‹éƒ¨åˆ†ä½¿ç”¨â€œé—­åŒ…â€ä»£æ›¿åŽŸæ–‡ä¸­çš„â€Closureâ€ åå­—é‡ŒåŒ…å«äº†ä»€ä¹ˆï¼Ÿ å¦‚æžœä¸€é—¨è¯­è¨€å¯ä»¥å®žçŽ°å‘½åï¼Œä½ å°±å¯ä»¥é€šè¿‡å®žçŽ°ä¸­æ‰¾åˆ°å‘½ååŽŸå› ã€‚ä»–ä»¬åœ¨å‘½åçš„æ—¶å€™è‚¯å®šæ˜¯æœ‰ç›®çš„çš„ã€‚æ‰€ä»¥å½“ä½ æ€è€ƒâ€œä¸ºä»€ä¹ˆè¿™ä¹ˆå‘½åâ€çš„é—®é¢˜æ—¶ï¼Œä½ å¯èƒ½å°±ä¼šç†è§£è¯­æ³•çš„ç‰¹ç‚¹å’Œæ¦‚å¿µã€‚ ä¸ºä»€ä¹ˆæ˜¯é—­åŒ… çŽ°åœ¨äº¤æ¢ï¼šçœŸæ˜¯æé—®â€œä¸ºä»€ä¹ˆâ€è¿™ä¸ªé—®é¢˜ Swift åº•å±‚æ˜¯å¼€æºçš„ï¼Œç»å¸¸æœ‰ä¸€äº›æè¿°åœ¨åŒ…å«åœ¨å‘½åé‡Œã€‚ä½†æ˜¯é—­åŒ…åœ¨Swiftå¼€æºä¹‹å‰å°±å·²ç»å­˜åœ¨äº†ã€‚è¿™å¯å¯¼è‡´ï¼Œæˆ‘çœŸçš„æ‰¾ä¸åˆ°å¤ªå¤šçš„è®ºç‚¹è¯´æ˜Žé—­åŒ…é—®ä»€ä¹ˆå«â€œé—­åŒ…â€ã€‚ åˆ†æ‹†å¼€é—­åŒ…ï¼ˆæ„Ÿè°¢ï¼Œthesaurus.comï¼ï¼‰ æ‰€ä»¥â€¦æˆ‘ä»¬å°†å¼€å§‹é€šè¿‡è®¨è®ºä»¥è¡¨è¾¾ä»€ä¹ˆæ˜¯é—­åŒ…ã€‚ å®˜æ–¹æ–‡æ¡£ä¸­é—­åŒ…çš„æè¿°â€œClosures are self-contained blocks of functionality that can be passed around and used in your code.â€ï¼ˆApple Developer Docsï¼‰ã€‚éœ€è¦æ·±ç©¶çš„æ˜¯â€”â€”ä¸ºä»€ä¹ˆå«ä»–ä»¬â€functionsâ€?? å°½æˆ‘æ‰€èƒ½çš„æ‹†å¼€è¿™ä¸ªè¯ï¼Œå½“æˆ‘åœ¨åŒä¹‰è¯ç½‘ç«™æŸ¥è¯¢é—­åŒ…çš„è¿‘ä¹‰è¯æ—¶ï¼Œæˆ‘èŽ·å–åˆ°è¿™äº› Plug Seal Cork åœ¨è¿™äº›é—­åŒ…çš„è¿‘ä¹‰è¯è¯éƒ½æ˜¯å¥½åƒéƒ½æ˜¯å›´ç»•ç€â€¦æŸäº›ä¸œè¥¿ã€‚ å¥½å§ï¼Œé‚£ä¹ˆé—­åŒ…å›´ç»•ç€ä»€ä¹ˆï¼Ÿå¥½é—®é¢˜ï¼ å‰ªçŸ­çš„å›žç­”ï¼Œå˜é‡ Variables å½“åœ¨äº’è”ç½‘ä¸Šä»”ç»†é˜…è¯»ä»€ä¹ˆæ˜¯é—­åŒ…çš„æ—¶å€™ï¼Œä¸å¯é¿å…çš„æˆ–å‡ºçŽ°é€šè¿‡Appleâ€™s æ¨¡æ‹Ÿå™¨ï¼Œç­‰ç›¸å…³å¼•ç”¨ã€‚é•¿æ—¶é—´æŸ¥é˜…åŽï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€äº›å…³é”®å­—æŒ‡å‘äº†â€œæ•èŽ·å˜é‡â€å’Œâ€œé”å®šå˜é‡â€ã€‚ è¿™äº›çŸ­è¯­å°±åƒæ˜¯ä¸€æ»©æµ‘æ°´ï¼ˆå¯¹æˆ‘æ¥è¯´ï¼‰ï¼Œä¸æ˜¯èƒ½å®Œå…¨æ¸…æ¥šâ€œæ•èŽ·å˜é‡â€æˆ–â€œé”å®šå˜é‡â€œçš„æ„æ€ï¼ŒçŸ¥é“æˆ‘çœ‹åˆ°äº†â€Plugâ€œã€â€Sealâ€œå’Œâ€Corkâ€œã€‚ ä¸€çž¬é—´èŒ…å¡žé¡¿å¼€ã€‚ ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªåœºæ™¯éœ€è¦ä½ æƒ³æƒ³ä¸€ä¸ªåœºæ™¯ï¼ŒæŠŠæ–¹æ³•æƒ³è±¡æˆä¸€ä¸ªç©ºçš„æ³³æ± ã€‚å°±æ˜¯ä¸€ä¸ªSwwingpool.Empty ç¨‹åºå¼€å§‹è¿è¡Œï¼Œä¹‹åŽåŒä¸€æ—¶åˆ»ä½ çš„ç¨‹åºæœ‰å¾ˆå¤šæ–¹æ³•æ‰§è¡Œäº†å›žè°ƒã€‚å½“å¼€å§‹æ‰§è¡Œç¨‹åºåŽï¼Œæ°´æ¶Œå…¥å¡«å……æ± å­ã€‚ä¸€æ‰“ç¡¬å¸è¿›å…¥äº†æ°´é‡Œã€‚ ç¡¬å¸ä»£è¡¨äº†å˜é‡ï¼Œç”±æ–¹æ³•ä¹Ÿå°±æ˜¯æ± å­åˆ›å»ºå¹¶ä½¿ç”¨ã€‚ æ–¹æ³•æ‰§è¡Œäº†æ‰€æœ‰çš„returnè¿”å›žäº†å…³é”®å­—ï¼Œå¹¶æŠŠæ‰€æœ‰çš„è¿”å›žå€¼æŽ’é™¤äº†æ± å­ã€‚æ¯«ç§’çº§å†…ï¼Œæ± å­çš„æ°´è¢«å¸å‡ºäº†ã€‚ å½“æ‰€æœ‰çš„ç¡¬å¸éƒ½åœ¨æ± å­é‡Œä¼šå‘ç”Ÿä»€ä¹ˆ å½“ç„¶ï¼Œæ‰€æœ‰çš„å˜è„¸éƒ½ä¼šè¢«å†²èµ°ï¼Œæ‰€æœ‰çš„ä¸€åˆ‡éƒ½åƒæ˜¯æ²¡å‘ç”Ÿè¿‡ï¼Œå½“æ–¹æ³•æ‰§è¡Œäº†returnï¼Œä½ çš„æ± å­å°±è¢«æ¸…ç©ºäº†ã€‚ å½“æ–¹æ³•æ‰§è¡Œreturnï¼Œæ‰€æœ‰ç”±æ–¹æ³•åˆ›å»ºçš„å˜é‡è¢«æ¸…é™¤é™¤äº†å†…å­˜ã€‚ é™¤éžâ€¦å¦‚æžœï¼Œæ± å­é‡Œä»»ç„¶æœ‰æ°´ï¼Œä½ ä»»ç„¶å¯ä»¥æ½œè¿›åŽ»ï¼Œæ‰”ä¸‹æˆ–è€…å‰‘æ°”ä¸€ä¸‹ç¡¬å¸ã€‚å¦‚æžœä½ å¯ä»¥æŠŠä»–æ”¾åœ¨ä¸€ä¸ªå®¹å™¨é‡Œï¼Œç”¨è½¯æœ¨å¡žæˆ–è€…å…¶ä»–å®¹å™¨å¯†å°ã€‚ å¦‚æžœä½ åšäº†è¿™ä¸ªï¼Œè¿™äº›ç¡¬å¸ä¾ç„¶å¯ä»¥è¢«ä½¿ç”¨ï¼Œå³æ—¶æ± å­è¢«æŽ’é™¤äº†æ°´ï¼ˆå½“æ–¹æ³•æ‰§è¡Œäº†returnï¼‰ã€‚ å¦‚æžœéœ€è¦çš„è¯ä¸€ä¸ªé—­åŒ…å¯ä»¥è¢«ä½œä¸ºä¸€ç§åœ¨æ± å­é‡Œé“²å‡ºç¡¬å¸ï¼ˆå˜é‡æˆ–è€…å®¹å™¨ï¼‰çš„æœºåˆ¶ï¼Œå¹¶å¯†å°å®ƒè‡ªå·±ï¼ŒçŸ¥é“è¶…æ–¹æ³•æ¸…ç©ºå®ƒå’Œç¡¬å¸ã€‚ é—­åŒ…å®žè·µå½“ä½ ä»Žå®˜æ–¹æ–‡æ¡£å¾—çŸ¥ â€œself-contained blocks of functionality that can be passed around and used in your code.â€ï¼Œä¹Ÿè®¸ä½ ä¼šæ„è¯†åˆ°è¿™ç‚¹ï¼Œä»–ä»¬ä»ŽçŽ¯å¢ƒä¸­èŽ·å–å˜é‡ï¼Œæ‰“åŒ…å¹¶å¯†å°å˜é‡ï¼Œæ¥è¾¾åˆ°ä¿æŠ¤å˜é‡çš„ç›®çš„ã€‚ äº‹å®žè¯æ˜Žï¼Œä½ åˆ›å»ºçš„æ‰€æœ‰é—­åŒ…éƒ½æœ‰è¿™æ ·çš„èƒ½åŠ›ã€‚ å¹¶ä¸æ˜¯æ‰€æœ‰çš„è¿”å›žå¹¶é”å®šå˜é‡ï¼Œä½†æ˜¯Swiftçš„æ‰€æœ‰é—­åŒ…éƒ½æœ‰è¿™æ ·çš„åŠŸèƒ½ã€‚ è¿™å¯èƒ½å°±æ˜¯é—­åŒ…ä¸ºä»€ä¹ˆå«â€é—­åŒ…â€œå§ã€‚ â€‹ å¥½å§ï¼Œæˆ‘å¯èƒ½ç†è§£äº†ä½œè€…çš„æ„æ€ï¼Œä½†æ˜¯æ¯”å–»æ–¹æ³•~ä¸æ˜¯å¾ˆç†è§£ã€‚]]></content>
      <categories>
        <category>Swift</category>
      </categories>
      <tags>
        <tag>Closure</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ–°çš„ä¸€å¤©]]></title>
    <url>%2F2017%2F06%2F15%2F%E6%96%B0%E7%9A%84%E4%B8%80%E5%A4%A9%2F</url>
    <content type="text"><![CDATA[UIå°éœ€æ±‚ æ ¹æ®è¿”å›žæ•°æ®åŠ è½½ç±»ä¼¼æœ‹å‹åœˆè§†å›¾ æ€è·¯ï¼šé€šè¿‡é›†åˆè§†å›¾ï¼Œæ ¹æ®è¿”å›žå­—æ®µå†…å®¹å®žçŽ°å¯¹åº”çš„itemç±»åž‹ï¼Œæ¨¡åž‹ä¸­è®¡ç®—UIåº”çš„é«˜åº¦å±žæ€§ã€‚ ä½†æ˜¯åœ¨å®žçŽ°çš„æ—¶å€™é‡åˆ°äº†å°å°çš„é—®é¢˜ã€‚ æœ€å¼€å§‹ä½¿ç”¨çš„æ˜¯xibå®žçŽ°ï¼Œæ‹–å‡ºNSLayoutConstraintå¹¶è¿›è¡Œä¿®æ”¹ã€‚ æœ€æ€•ä½†æ˜¯ï¼Œè¿™ä¸ªweekå¼•ç”¨çš„NSLayoutConstraintå¯¹è±¡åªèƒ½ä¿®æ”¹constant/multiplierå±žæ€§ã€‚å“ªæ€•~é‡æ–°åˆ¶å®šæ–°çš„NSLayoutConstraintå¯¹è±¡éƒ½æ— æµŽäºŽäº‹ã€‚ã€‚ã€‚è™½ç„¶ä¿®æ”¹äº†å¯¹åº”çš„NSLayoutConstraintå¯¹è±¡ï¼Œä½†æ˜¯ç¡®å®žæ²¡æœ‰æ›´æ”¹å¸ƒå±€ã€‚ å¥½å§ï¼ŒæŒ‰ç…§å¿«é€Ÿå¼€å‘çš„æ ‡å‡†ï¼ˆâ€œæ‡’â€ï¼‰ï¼Œå‡†å¤‡å¯¹åº”å¤šçš„å­ç±»ï¼Œå­ç±»çš„å¤§å°è¿˜æ˜¯å†™æ­»çš„ã€‚ä½†æ˜¯ç”±NetWorkManangeræ ¹æ®æ•°æ®å†³å®šé‡‡ç”¨å“ªç§itemã€‚ é€šè¿‡åŠ è½½çš„æ•°æ®è®¡ç®—ä¸‹ï¼Œå¯¹åº”çš„itemå¤§å°ã€‚ é™¤äº†ä»£ç è€¦åˆåº¦æ¯”è¾ƒé«˜ä¹‹å¤–ï¼Œå…¶ä»–è¿˜æ˜¯å¾ˆæ»¡æ„çš„ã€‚ ä¸Šä¼ å¤šç»„æ•°ç»„ éœ€æ±‚ï¼šä¸Šä¼ å¤šç»„æ•°æ®ï¼Œåœ¨åŒä¸€ä¸ªé¡µé¢å†…å¯èƒ½ä¼šå¤šæ¬¡ä¸Šä¼ ã€‚å› æ­¤éœ€è¦å¯¹æ¯”ä¸Šä¼ çš„æ•°æ®æºã€‚ æ€è·¯ï¼šè®°å½•å½“å‰å·²ä¸Šä¼ çš„æ•°æ®ï¼Œæ¯æ¬¡ä¸Šä¼ å‰å¯¹æ¯”æ•°æ®ã€‚å¦‚æžœæ²¡æœ‰ä¸Šä¼ è¿‡åˆ™ä¸Šä¼ ã€‚ å®žçŽ°ï¼šå› ä¸ºå°†æ•°æ®å­˜æ”¾åœ¨æ•°ç»„ä¸­ï¼Œå› æ­¤è½¬æ¢æˆäº†NSSetå¯¹è±¡å¯¹æ¯”å‡ºå·®é›†ï¼Œä¸Šä¼ å·®é›†æ•°æ®ã€‚]]></content>
      <categories>
        <category>æ— èŠ</category>
      </categories>
      <tags>
        <tag>æ—¥å¸¸</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æˆ‘çš„åšå®¢]]></title>
    <url>%2F2017%2F06%2F10%2F%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2%2F</url>
    <content type="text"><![CDATA[this article is just to test myblog ,welcome. ç¬¬ä¸€æ¬¡åŠ¨æ‰‹åŽ»å†™Bolgï¼Œä¹‹å‰æœ‰ä¸ªäººå’Œæˆ‘è¯´ï¼šä¸ºä»€ä¹ˆä¸å†™åšå®¢å‘¢ï¼Ÿ å½“æ—¶çš„å›žç­”æ˜¯ä¸çŸ¥é“å†™ä»€ä¹ˆï¼Œå¤§å¤šä¹Ÿå°±æ˜¯å‚è€ƒä»–äººçš„ä¸œè¥¿ï¼Œæ‹¾äººç‰™æ…§è€Œå·²ã€‚ çŽ°åœ¨è§‰å¾—ä¹Ÿä¸æ˜¯å®Œå…¨æ²¡å¿…è¦ï¼Œä¹Ÿç®—æ˜¯æ¿€åŠ±è‡ªå·±çš„å­¦ä¹ è®°å½•è‡ªå·±è„šæ­¥çš„ä¸€ç§æ–¹å¼ï¼Œæ°å¥½æœ¬äººæ‡’å¾—å†™æ—¥è®°ã€‚]]></content>
      <categories>
        <category>æ— èŠ</category>
      </categories>
      <tags>
        <tag>æ—¥å¸¸</tag>
      </tags>
  </entry>
</search>